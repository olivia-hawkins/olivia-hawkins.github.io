var ia=Object.create;var ds=Object.defineProperty;var sa=Object.getOwnPropertyDescriptor;var oa=Object.getOwnPropertyNames;var aa=Object.getPrototypeOf,ua=Object.prototype.hasOwnProperty;var P=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var la=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of oa(e))!ua.call(n,i)&&i!==t&&ds(n,i,{get:()=>e[i],enumerable:!(r=sa(e,i))||r.enumerable});return n};var fs=(n,e,t)=>(t=n!=null?ia(aa(n)):{},la(e||!n||!n.__esModule?ds(t,"default",{value:n,enumerable:!0}):t,n));var qt=P((Gu,hi)=>{"use strict";var ca=Object.prototype.hasOwnProperty,Ee="~";function Ht(){}Object.create&&(Ht.prototype=Object.create(null),new Ht().__proto__||(Ee=!1));function da(n,e,t){this.fn=n,this.context=e,this.once=t||!1}function ps(n,e,t,r,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new da(t,r||n,i),c=Ee?Ee+e:e;return n._events[c]?n._events[c].fn?n._events[c]=[n._events[c],o]:n._events[c].push(o):(n._events[c]=o,n._eventsCount++),n}function Tr(n,e){--n._eventsCount===0?n._events=new Ht:delete n._events[e]}function we(){this._events=new Ht,this._eventsCount=0}we.prototype.eventNames=function(){var e=[],t,r;if(this._eventsCount===0)return e;for(r in t=this._events)ca.call(t,r)&&e.push(Ee?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};we.prototype.listeners=function(e){var t=Ee?Ee+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,c=new Array(o);i<o;i++)c[i]=r[i].fn;return c};we.prototype.listenerCount=function(e){var t=Ee?Ee+e:e,r=this._events[t];return r?r.fn?1:r.length:0};we.prototype.emit=function(e,t,r,i,o,c){var h=Ee?Ee+e:e;if(!this._events[h])return!1;var p=this._events[h],S=arguments.length,D,C;if(p.fn){switch(p.once&&this.removeListener(e,p.fn,void 0,!0),S){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,t),!0;case 3:return p.fn.call(p.context,t,r),!0;case 4:return p.fn.call(p.context,t,r,i),!0;case 5:return p.fn.call(p.context,t,r,i,o),!0;case 6:return p.fn.call(p.context,t,r,i,o,c),!0}for(C=1,D=new Array(S-1);C<S;C++)D[C-1]=arguments[C];p.fn.apply(p.context,D)}else{var oe=p.length,k;for(C=0;C<oe;C++)switch(p[C].once&&this.removeListener(e,p[C].fn,void 0,!0),S){case 1:p[C].fn.call(p[C].context);break;case 2:p[C].fn.call(p[C].context,t);break;case 3:p[C].fn.call(p[C].context,t,r);break;case 4:p[C].fn.call(p[C].context,t,r,i);break;default:if(!D)for(k=1,D=new Array(S-1);k<S;k++)D[k-1]=arguments[k];p[C].fn.apply(p[C].context,D)}}return!0};we.prototype.on=function(e,t,r){return ps(this,e,t,r,!1)};we.prototype.once=function(e,t,r){return ps(this,e,t,r,!0)};we.prototype.removeListener=function(e,t,r,i){var o=Ee?Ee+e:e;if(!this._events[o])return this;if(!t)return Tr(this,o),this;var c=this._events[o];if(c.fn)c.fn===t&&(!i||c.once)&&(!r||c.context===r)&&Tr(this,o);else{for(var h=0,p=[],S=c.length;h<S;h++)(c[h].fn!==t||i&&!c[h].once||r&&c[h].context!==r)&&p.push(c[h]);p.length?this._events[o]=p.length===1?p[0]:p:Tr(this,o)}return this};we.prototype.removeAllListeners=function(e){var t;return e?(t=Ee?Ee+e:e,this._events[t]&&Tr(this,t)):(this._events=new Ht,this._eventsCount=0),this};we.prototype.off=we.prototype.removeListener;we.prototype.addListener=we.prototype.on;we.prefixed=Ee;we.EventEmitter=we;typeof hi<"u"&&(hi.exports=we)});var gi=P(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});ut.ButtplugLogger=ut.LogMessage=ut.ButtplugLogLevel=void 0;var fa=qt(),Ye;(function(n){n[n.Off=0]="Off",n[n.Error=1]="Error",n[n.Warn=2]="Warn",n[n.Info=3]="Info",n[n.Debug=4]="Debug",n[n.Trace=5]="Trace"})(Ye||(ut.ButtplugLogLevel=Ye={}));var Er=class{constructor(e,t){let r=new Date,i=r.getHours(),o=r.getMinutes(),c=r.getSeconds();this.timestamp=`${i}:${o}:${c}`,this.logMessage=e,this.logLevel=t}get Message(){return this.logMessage}get LogLevel(){return this.logLevel}get Timestamp(){return this.timestamp}get FormattedMessage(){return`${Ye[this.logLevel]} : ${this.timestamp} : ${this.logMessage}`}};ut.LogMessage=Er;var at=class extends fa.EventEmitter{static get Logger(){return at.sLogger===void 0&&(at.sLogger=new at),this.sLogger}constructor(){super(),this.maximumConsoleLogLevel=Ye.Off,this.maximumEventLogLevel=Ye.Off}get MaximumConsoleLogLevel(){return this.maximumConsoleLogLevel}set MaximumConsoleLogLevel(e){this.maximumConsoleLogLevel=e}get MaximumEventLogLevel(){return this.maximumEventLogLevel}set MaximumEventLogLevel(e){this.maximumEventLogLevel=e}Error(e){this.AddLogMessage(e,Ye.Error)}Warn(e){this.AddLogMessage(e,Ye.Warn)}Info(e){this.AddLogMessage(e,Ye.Info)}Debug(e){this.AddLogMessage(e,Ye.Debug)}Trace(e){this.AddLogMessage(e,Ye.Trace)}AddLogMessage(e,t){if(t>this.maximumEventLogLevel&&t>this.maximumConsoleLogLevel)return;let r=new Er(e,t);t<=this.maximumConsoleLogLevel&&console.log(r.FormattedMessage),t<=this.maximumEventLogLevel&&this.emit("log",r)}};ut.ButtplugLogger=at;at.sLogger=void 0});var hs=P(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.TransformationType=void 0;var pa;(function(n){n[n.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",n[n.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",n[n.CLASS_TO_CLASS=2]="CLASS_TO_CLASS"})(pa=Gt.TransformationType||(Gt.TransformationType={}))});var zt=P(bt=>{"use strict";var ha=bt&&bt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),ga=bt&&bt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ha(e,n,t)};Object.defineProperty(bt,"__esModule",{value:!0});ga(hs(),bt)});var gs=P(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.MetadataStorage=void 0;var Ze=zt(),vi=class{constructor(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}addTypeMetadata(e){this._typeMetadatas.has(e.target)||this._typeMetadatas.set(e.target,new Map),this._typeMetadatas.get(e.target).set(e.propertyName,e)}addTransformMetadata(e){this._transformMetadatas.has(e.target)||this._transformMetadatas.set(e.target,new Map),this._transformMetadatas.get(e.target).has(e.propertyName)||this._transformMetadatas.get(e.target).set(e.propertyName,[]),this._transformMetadatas.get(e.target).get(e.propertyName).push(e)}addExposeMetadata(e){this._exposeMetadatas.has(e.target)||this._exposeMetadatas.set(e.target,new Map),this._exposeMetadatas.get(e.target).set(e.propertyName,e)}addExcludeMetadata(e){this._excludeMetadatas.has(e.target)||this._excludeMetadatas.set(e.target,new Map),this._excludeMetadatas.get(e.target).set(e.propertyName,e)}findTransformMetadatas(e,t,r){return this.findMetadatas(this._transformMetadatas,e,t).filter(i=>!i.options||i.options.toClassOnly===!0&&i.options.toPlainOnly===!0?!0:i.options.toClassOnly===!0?r===Ze.TransformationType.CLASS_TO_CLASS||r===Ze.TransformationType.PLAIN_TO_CLASS:i.options.toPlainOnly===!0?r===Ze.TransformationType.CLASS_TO_PLAIN:!0)}findExcludeMetadata(e,t){return this.findMetadata(this._excludeMetadatas,e,t)}findExposeMetadata(e,t){return this.findMetadata(this._exposeMetadatas,e,t)}findExposeMetadataByCustomName(e,t){return this.getExposedMetadatas(e).find(r=>r.options&&r.options.name===t)}findTypeMetadata(e,t){return this.findMetadata(this._typeMetadatas,e,t)}getStrategy(e){let t=this._excludeMetadatas.get(e),r=t&&t.get(void 0),i=this._exposeMetadatas.get(e),o=i&&i.get(void 0);return r&&o||!r&&!o?"none":r?"excludeAll":"exposeAll"}getExposedMetadatas(e){return this.getMetadata(this._exposeMetadatas,e)}getExcludedMetadatas(e){return this.getMetadata(this._excludeMetadatas,e)}getExposedProperties(e,t){return this.getExposedMetadatas(e).filter(r=>!r.options||r.options.toClassOnly===!0&&r.options.toPlainOnly===!0?!0:r.options.toClassOnly===!0?t===Ze.TransformationType.CLASS_TO_CLASS||t===Ze.TransformationType.PLAIN_TO_CLASS:r.options.toPlainOnly===!0?t===Ze.TransformationType.CLASS_TO_PLAIN:!0).map(r=>r.propertyName)}getExcludedProperties(e,t){return this.getExcludedMetadatas(e).filter(r=>!r.options||r.options.toClassOnly===!0&&r.options.toPlainOnly===!0?!0:r.options.toClassOnly===!0?t===Ze.TransformationType.CLASS_TO_CLASS||t===Ze.TransformationType.PLAIN_TO_CLASS:r.options.toPlainOnly===!0?t===Ze.TransformationType.CLASS_TO_PLAIN:!0).map(r=>r.propertyName)}clear(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()}getMetadata(e,t){let r=e.get(t),i;r&&(i=Array.from(r.values()).filter(c=>c.propertyName!==void 0));let o=[];for(let c of this.getAncestors(t)){let h=e.get(c);if(h){let p=Array.from(h.values()).filter(S=>S.propertyName!==void 0);o.push(...p)}}return o.concat(i||[])}findMetadata(e,t,r){let i=e.get(t);if(i){let o=i.get(r);if(o)return o}for(let o of this.getAncestors(t)){let c=e.get(o);if(c){let h=c.get(r);if(h)return h}}}findMetadatas(e,t,r){let i=e.get(t),o;i&&(o=i.get(r));let c=[];for(let h of this.getAncestors(t)){let p=e.get(h);p&&p.has(r)&&c.push(...p.get(r))}return c.slice().reverse().concat((o||[]).slice().reverse())}getAncestors(e){if(!e)return[];if(!this._ancestorsMap.has(e)){let t=[];for(let r=Object.getPrototypeOf(e.prototype.constructor);typeof r.prototype<"u";r=Object.getPrototypeOf(r.prototype.constructor))t.push(r);this._ancestorsMap.set(e,t)}return this._ancestorsMap.get(e)}};Or.MetadataStorage=vi});var Et=P(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.defaultMetadataStorage=void 0;var va=gs();Lr.defaultMetadataStorage=new va.MetadataStorage});var vs=P(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0});Cr.getGlobal=void 0;function ma(){if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global;if(typeof window<"u")return window;if(typeof self<"u")return self}Cr.getGlobal=ma});var ms=P(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.isPromise=void 0;function ba(n){return n!==null&&typeof n=="object"&&typeof n.then=="function"}Dr.isPromise=ba});var ys=P(lt=>{"use strict";var ya=lt&&lt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),bs=lt&&lt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ya(e,n,t)};Object.defineProperty(lt,"__esModule",{value:!0});bs(vs(),lt);bs(ms(),lt)});var _s=P(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.TransformOperationExecutor=void 0;var xe=Et(),de=zt(),Ss=ys();function Sa(n){let e=new n;return!(e instanceof Set)&&!("push"in e)?[]:e}var mi=class{constructor(e,t){this.transformationType=e,this.options=t,this.recursionStack=new Set}transform(e,t,r,i,o,c=0){if(Array.isArray(t)||t instanceof Set){let h=i&&this.transformationType===de.TransformationType.PLAIN_TO_CLASS?Sa(i):[];return t.forEach((p,S)=>{let D=e?e[S]:void 0;if(!this.options.enableCircularCheck||!this.isCircular(p)){let C;if(typeof r!="function"&&r&&r.options&&r.options.discriminator&&r.options.discriminator.property&&r.options.discriminator.subTypes){if(this.transformationType===de.TransformationType.PLAIN_TO_CLASS){C=r.options.discriminator.subTypes.find(_e=>_e.name===p[r.options.discriminator.property]);let k={newObject:h,object:p,property:void 0},se=r.typeFunction(k);C===void 0?C=se:C=C.value,r.options.keepDiscriminatorProperty||delete p[r.options.discriminator.property]}this.transformationType===de.TransformationType.CLASS_TO_CLASS&&(C=p.constructor),this.transformationType===de.TransformationType.CLASS_TO_PLAIN&&(p[r.options.discriminator.property]=r.options.discriminator.subTypes.find(k=>k.value===p.constructor).name)}else C=r;let oe=this.transform(D,p,C,void 0,p instanceof Map,c+1);h instanceof Set?h.add(oe):h.push(oe)}else this.transformationType===de.TransformationType.CLASS_TO_CLASS&&(h instanceof Set?h.add(p):h.push(p))}),h}else{if(r===String&&!o)return t==null?t:String(t);if(r===Number&&!o)return t==null?t:Number(t);if(r===Boolean&&!o)return t==null?t:!!t;if((r===Date||t instanceof Date)&&!o)return t instanceof Date?new Date(t.valueOf()):t==null?t:new Date(t);if((0,Ss.getGlobal)().Buffer&&(r===Buffer||t instanceof Buffer)&&!o)return t==null?t:Buffer.from(t);if((0,Ss.isPromise)(t)&&!o)return new Promise((h,p)=>{t.then(S=>h(this.transform(void 0,S,r,void 0,void 0,c+1)),p)});if(!o&&t!==null&&typeof t=="object"&&typeof t.then=="function")return t;if(typeof t=="object"&&t!==null){!r&&t.constructor!==Object&&(!Array.isArray(t)&&t.constructor===Array||(r=t.constructor)),!r&&e&&(r=e.constructor),this.options.enableCircularCheck&&this.recursionStack.add(t);let h=this.getKeys(r,t,o),p=e||{};!e&&(this.transformationType===de.TransformationType.PLAIN_TO_CLASS||this.transformationType===de.TransformationType.CLASS_TO_CLASS)&&(o?p=new Map:r?p=new r:p={});for(let S of h){if(S==="__proto__"||S==="constructor")continue;let D=S,C=S,oe=S;if(!this.options.ignoreDecorators&&r){if(this.transformationType===de.TransformationType.PLAIN_TO_CLASS){let F=xe.defaultMetadataStorage.findExposeMetadataByCustomName(r,S);F&&(oe=F.propertyName,C=F.propertyName)}else if(this.transformationType===de.TransformationType.CLASS_TO_PLAIN||this.transformationType===de.TransformationType.CLASS_TO_CLASS){let F=xe.defaultMetadataStorage.findExposeMetadata(r,S);F&&F.options&&F.options.name&&(C=F.options.name)}}let k;this.transformationType===de.TransformationType.PLAIN_TO_CLASS?k=t[D]:t instanceof Map?k=t.get(D):t[D]instanceof Function?k=t[D]():k=t[D];let se,_e=k instanceof Map;if(r&&o)se=r;else if(r){let F=xe.defaultMetadataStorage.findTypeMetadata(r,oe);if(F){let Y={newObject:p,object:t,property:oe},ht=F.typeFunction?F.typeFunction(Y):F.reflectedType;F.options&&F.options.discriminator&&F.options.discriminator.property&&F.options.discriminator.subTypes?t[D]instanceof Array?se=F:(this.transformationType===de.TransformationType.PLAIN_TO_CLASS&&(se=F.options.discriminator.subTypes.find(rt=>{if(k&&k instanceof Object&&F.options.discriminator.property in k)return rt.name===k[F.options.discriminator.property]}),se===void 0?se=ht:se=se.value,F.options.keepDiscriminatorProperty||k&&k instanceof Object&&F.options.discriminator.property in k&&delete k[F.options.discriminator.property]),this.transformationType===de.TransformationType.CLASS_TO_CLASS&&(se=k.constructor),this.transformationType===de.TransformationType.CLASS_TO_PLAIN&&k&&(k[F.options.discriminator.property]=F.options.discriminator.subTypes.find(rt=>rt.value===k.constructor).name)):se=ht,_e=_e||F.reflectedType===Map}else if(this.options.targetMaps)this.options.targetMaps.filter(Y=>Y.target===r&&!!Y.properties[oe]).forEach(Y=>se=Y.properties[oe]);else if(this.options.enableImplicitConversion&&this.transformationType===de.TransformationType.PLAIN_TO_CLASS){let Y=Reflect.getMetadata("design:type",r.prototype,oe);Y&&(se=Y)}}let ze=Array.isArray(t[D])?this.getReflectedType(r,oe):void 0,tt=e?e[D]:void 0;if(p.constructor.prototype){let F=Object.getOwnPropertyDescriptor(p.constructor.prototype,C);if((this.transformationType===de.TransformationType.PLAIN_TO_CLASS||this.transformationType===de.TransformationType.CLASS_TO_CLASS)&&(F&&!F.set||p[C]instanceof Function))continue}if(!this.options.enableCircularCheck||!this.isCircular(k)){let F=this.transformationType===de.TransformationType.PLAIN_TO_CLASS?C:S,Y;this.transformationType===de.TransformationType.CLASS_TO_PLAIN?(Y=t[F],Y=this.applyCustomTransformations(Y,r,F,t,this.transformationType),Y=t[F]===Y?k:Y,Y=this.transform(tt,Y,se,ze,_e,c+1)):k===void 0&&this.options.exposeDefaultValues?Y=p[C]:(Y=this.transform(tt,k,se,ze,_e,c+1),Y=this.applyCustomTransformations(Y,r,F,t,this.transformationType)),(Y!==void 0||this.options.exposeUnsetFields)&&(p instanceof Map?p.set(C,Y):p[C]=Y)}else if(this.transformationType===de.TransformationType.CLASS_TO_CLASS){let F=k;F=this.applyCustomTransformations(F,r,S,t,this.transformationType),(F!==void 0||this.options.exposeUnsetFields)&&(p instanceof Map?p.set(C,F):p[C]=F)}}return this.options.enableCircularCheck&&this.recursionStack.delete(t),p}else return t}}applyCustomTransformations(e,t,r,i,o){let c=xe.defaultMetadataStorage.findTransformMetadatas(t,r,this.transformationType);return this.options.version!==void 0&&(c=c.filter(h=>h.options?this.checkVersion(h.options.since,h.options.until):!0)),this.options.groups&&this.options.groups.length?c=c.filter(h=>h.options?this.checkGroups(h.options.groups):!0):c=c.filter(h=>!h.options||!h.options.groups||!h.options.groups.length),c.forEach(h=>{e=h.transformFn({value:e,key:r,obj:i,type:o,options:this.options})}),e}isCircular(e){return this.recursionStack.has(e)}getReflectedType(e,t){if(!e)return;let r=xe.defaultMetadataStorage.findTypeMetadata(e,t);return r?r.reflectedType:void 0}getKeys(e,t,r){let i=xe.defaultMetadataStorage.getStrategy(e);i==="none"&&(i=this.options.strategy||"exposeAll");let o=[];if((i==="exposeAll"||r)&&(t instanceof Map?o=Array.from(t.keys()):o=Object.keys(t)),r)return o;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&e){let c=xe.defaultMetadataStorage.getExposedProperties(e,this.transformationType),h=xe.defaultMetadataStorage.getExcludedProperties(e,this.transformationType);o=[...c,...h]}if(!this.options.ignoreDecorators&&e){let c=xe.defaultMetadataStorage.getExposedProperties(e,this.transformationType);this.transformationType===de.TransformationType.PLAIN_TO_CLASS&&(c=c.map(p=>{let S=xe.defaultMetadataStorage.findExposeMetadata(e,p);return S&&S.options&&S.options.name?S.options.name:p})),this.options.excludeExtraneousValues?o=c:o=o.concat(c);let h=xe.defaultMetadataStorage.getExcludedProperties(e,this.transformationType);h.length>0&&(o=o.filter(p=>!h.includes(p))),this.options.version!==void 0&&(o=o.filter(p=>{let S=xe.defaultMetadataStorage.findExposeMetadata(e,p);return!S||!S.options?!0:this.checkVersion(S.options.since,S.options.until)})),this.options.groups&&this.options.groups.length?o=o.filter(p=>{let S=xe.defaultMetadataStorage.findExposeMetadata(e,p);return!S||!S.options?!0:this.checkGroups(S.options.groups)}):o=o.filter(p=>{let S=xe.defaultMetadataStorage.findExposeMetadata(e,p);return!S||!S.options||!S.options.groups||!S.options.groups.length})}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(o=o.filter(c=>this.options.excludePrefixes.every(h=>c.substr(0,h.length)!==h))),o=o.filter((c,h,p)=>p.indexOf(c)===h),o}checkVersion(e,t){let r=!0;return r&&e&&(r=this.options.version>=e),r&&t&&(r=this.options.version<t),r}checkGroups(e){return e?this.options.groups.some(t=>e.includes(t)):!0}};Ar.TransformOperationExecutor=mi});var Ms=P(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.defaultOptions=void 0;xr.defaultOptions={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0}});var Dt=P(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});Pr.ClassTransformer=void 0;var Ot=_s(),Lt=zt(),Ct=Ms(),bi=class{instanceToPlain(e,t){return new Ot.TransformOperationExecutor(Lt.TransformationType.CLASS_TO_PLAIN,{...Ct.defaultOptions,...t}).transform(void 0,e,void 0,void 0,void 0,void 0)}classToPlainFromExist(e,t,r){return new Ot.TransformOperationExecutor(Lt.TransformationType.CLASS_TO_PLAIN,{...Ct.defaultOptions,...r}).transform(t,e,void 0,void 0,void 0,void 0)}plainToInstance(e,t,r){return new Ot.TransformOperationExecutor(Lt.TransformationType.PLAIN_TO_CLASS,{...Ct.defaultOptions,...r}).transform(void 0,t,e,void 0,void 0,void 0)}plainToClassFromExist(e,t,r){return new Ot.TransformOperationExecutor(Lt.TransformationType.PLAIN_TO_CLASS,{...Ct.defaultOptions,...r}).transform(e,t,void 0,void 0,void 0,void 0)}instanceToInstance(e,t){return new Ot.TransformOperationExecutor(Lt.TransformationType.CLASS_TO_CLASS,{...Ct.defaultOptions,...t}).transform(void 0,e,void 0,void 0,void 0,void 0)}classToClassFromExist(e,t,r){return new Ot.TransformOperationExecutor(Lt.TransformationType.CLASS_TO_CLASS,{...Ct.defaultOptions,...r}).transform(t,e,void 0,void 0,void 0,void 0)}serialize(e,t){return JSON.stringify(this.instanceToPlain(e,t))}deserialize(e,t,r){let i=JSON.parse(t);return this.plainToInstance(e,i,r)}deserializeArray(e,t,r){let i=JSON.parse(t);return this.plainToInstance(e,i,r)}};Pr.ClassTransformer=bi});var ws=P(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.Exclude=void 0;var _a=Et();function Ma(n={}){return function(e,t){_a.defaultMetadataStorage.addExcludeMetadata({target:e instanceof Function?e:e.constructor,propertyName:t,options:n})}}Rr.Exclude=Ma});var Ts=P(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});Ir.Expose=void 0;var wa=Et();function Ta(n={}){return function(e,t){wa.defaultMetadataStorage.addExposeMetadata({target:e instanceof Function?e:e.constructor,propertyName:t,options:n})}}Ir.Expose=Ta});var Es=P(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.TransformInstanceToInstance=void 0;var Ea=Dt();function Oa(n){return function(e,t,r){let i=new Ea.ClassTransformer,o=r.value;r.value=function(...c){let h=o.apply(this,c);return!!h&&(typeof h=="object"||typeof h=="function")&&typeof h.then=="function"?h.then(S=>i.instanceToInstance(S,n)):i.instanceToInstance(h,n)}}}Br.TransformInstanceToInstance=Oa});var Os=P(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.TransformInstanceToPlain=void 0;var La=Dt();function Ca(n){return function(e,t,r){let i=new La.ClassTransformer,o=r.value;r.value=function(...c){let h=o.apply(this,c);return!!h&&(typeof h=="object"||typeof h=="function")&&typeof h.then=="function"?h.then(S=>i.instanceToPlain(S,n)):i.instanceToPlain(h,n)}}}Fr.TransformInstanceToPlain=Ca});var Ls=P(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.TransformPlainToInstance=void 0;var Da=Dt();function Aa(n,e){return function(t,r,i){let o=new Da.ClassTransformer,c=i.value;i.value=function(...h){let p=c.apply(this,h);return!!p&&(typeof p=="object"||typeof p=="function")&&typeof p.then=="function"?p.then(D=>o.plainToInstance(n,D,e)):o.plainToInstance(n,p,e)}}}jr.TransformPlainToInstance=Aa});var Cs=P(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.Transform=void 0;var xa=Et();function Pa(n,e={}){return function(t,r){xa.defaultMetadataStorage.addTransformMetadata({target:t.constructor,propertyName:r,transformFn:n,options:e})}}Nr.Transform=Pa});var Ds=P(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.Type=void 0;var Ra=Et();function Ia(n,e={}){return function(t,r){let i=Reflect.getMetadata("design:type",t,r);Ra.defaultMetadataStorage.addTypeMetadata({target:t.constructor,propertyName:r,reflectedType:i,typeFunction:n,options:e})}}kr.Type=Ia});var As=P(Be=>{"use strict";var Ba=Be&&Be.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),yt=Be&&Be.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ba(e,n,t)};Object.defineProperty(Be,"__esModule",{value:!0});yt(ws(),Be);yt(Ts(),Be);yt(Es(),Be);yt(Os(),Be);yt(Ls(),Be);yt(Cs(),Be);yt(Ds(),Be)});var Ps=P(xs=>{"use strict";Object.defineProperty(xs,"__esModule",{value:!0})});var Is=P(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0})});var Fs=P(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0})});var Ns=P(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0})});var Us=P(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0})});var Vs=P($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0})});var Hs=P(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0})});var Gs=P(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0})});var Js=P(zs=>{"use strict";Object.defineProperty(zs,"__esModule",{value:!0})});var Ks=P(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0})});var Zs=P(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0})});var eo=P(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0})});var ro=P(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0})});var io=P(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0})});var so=P(pe=>{"use strict";var Fa=pe&&pe.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Pe=pe&&pe.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Fa(e,n,t)};Object.defineProperty(pe,"__esModule",{value:!0});Pe(Ps(),pe);Pe(Is(),pe);Pe(Fs(),pe);Pe(Ns(),pe);Pe(Us(),pe);Pe(Vs(),pe);Pe(Hs(),pe);Pe(Gs(),pe);Pe(Js(),pe);Pe(Ks(),pe);Pe(Zs(),pe);Pe(eo(),pe);Pe(ro(),pe);Pe(io(),pe)});var Si=P(G=>{"use strict";var ja=G&&G.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),yi=G&&G.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ja(e,n,t)};Object.defineProperty(G,"__esModule",{value:!0});G.deserializeArray=G.deserialize=G.serialize=G.classToClassFromExist=G.instanceToInstance=G.plainToClassFromExist=G.plainToInstance=G.plainToClass=G.classToPlainFromExist=G.instanceToPlain=G.classToPlain=G.ClassTransformer=void 0;var Na=Dt(),ka=Dt();Object.defineProperty(G,"ClassTransformer",{enumerable:!0,get:function(){return ka.ClassTransformer}});yi(As(),G);yi(so(),G);yi(zt(),G);var He=new Na.ClassTransformer;function Ua(n,e){return He.instanceToPlain(n,e)}G.classToPlain=Ua;function $a(n,e){return He.instanceToPlain(n,e)}G.instanceToPlain=$a;function Va(n,e,t){return He.classToPlainFromExist(n,e,t)}G.classToPlainFromExist=Va;function Wa(n,e,t){return He.plainToInstance(n,e,t)}G.plainToClass=Wa;function Ha(n,e,t){return He.plainToInstance(n,e,t)}G.plainToInstance=Ha;function qa(n,e,t){return He.plainToClassFromExist(n,e,t)}G.plainToClassFromExist=qa;function Ga(n,e){return He.instanceToInstance(n,e)}G.instanceToInstance=Ga;function za(n,e,t){return He.classToClassFromExist(n,e,t)}G.classToClassFromExist=za;function Ja(n,e){return He.serialize(n,e)}G.serialize=Ja;function Ya(n,e,t){return He.deserialize(n,e,t)}G.deserialize=Ya;function Ka(n,e,t){return He.deserializeArray(n,e,t)}G.deserializeArray=Ka});var ao=P(()=>{var oo;(function(n){(function(e){var t=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:h(),r=i(n);typeof t.Reflect<"u"&&(r=i(t.Reflect,r)),e(r,t),typeof t.Reflect>"u"&&(t.Reflect=n);function i(p,S){return function(D,C){Object.defineProperty(p,D,{configurable:!0,writable:!0,value:C}),S&&S(D,C)}}function o(){try{return Function("return this;")()}catch{}}function c(){try{return(0,eval)("(function() { return this; })()")}catch{}}function h(){return o()||c()}})(function(e,t){var r=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",o=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",c=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",h=typeof Object.create=="function",p={__proto__:[]}instanceof Array,S=!h&&!p,D={create:h?function(){return kt(Object.create(null))}:p?function(){return kt({__proto__:null})}:function(){return kt({})},has:S?function(l,d){return r.call(l,d)}:function(l,d){return d in l},get:S?function(l,d){return r.call(l,d)?l[d]:void 0}:function(l,d){return l[d]}},C=Object.getPrototypeOf(Function),oe=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:kn(),k=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Un(),se=typeof WeakMap=="function"?WeakMap:$n(),_e=i?Symbol.for("@reflect-metadata:registry"):void 0,ze=fr(),tt=jn(ze);function F(l,d,g,y){if(I(g)){if(!Ft(l))throw new TypeError;if(!fe(d))throw new TypeError;return Rn(l,d)}else{if(!Ft(l))throw new TypeError;if(!te(d))throw new TypeError;if(!te(y)&&!I(y)&&!nt(y))throw new TypeError;return nt(y)&&(y=void 0),g=z(g),In(l,d,g,y)}}e("decorate",F);function Y(l,d){function g(y,x){if(!te(y))throw new TypeError;if(!I(x)&&!Bn(x))throw new TypeError;nr(l,d,y,x)}return g}e("metadata",Y);function ht(l,d,g,y){if(!te(g))throw new TypeError;return I(y)||(y=z(y)),nr(l,d,g,y)}e("defineMetadata",ht);function rt(l,d,g){if(!te(d))throw new TypeError;return I(g)||(g=z(g)),er(l,d,g)}e("hasMetadata",rt);function Ln(l,d,g){if(!te(d))throw new TypeError;return I(g)||(g=z(g)),Bt(l,d,g)}e("hasOwnMetadata",Ln);function Cn(l,d,g){if(!te(d))throw new TypeError;return I(g)||(g=z(g)),tr(l,d,g)}e("getMetadata",Cn);function Dn(l,d,g){if(!te(d))throw new TypeError;return I(g)||(g=z(g)),rr(l,d,g)}e("getOwnMetadata",Dn);function An(l,d){if(!te(l))throw new TypeError;return I(d)||(d=z(d)),ir(l,d)}e("getMetadataKeys",An);function xn(l,d){if(!te(l))throw new TypeError;return I(d)||(d=z(d)),sr(l,d)}e("getOwnMetadataKeys",xn);function Pn(l,d,g){if(!te(d))throw new TypeError;if(I(g)||(g=z(g)),!te(d))throw new TypeError;I(g)||(g=z(g));var y=gt(d,g,!1);return I(y)?!1:y.OrdinaryDeleteMetadata(l,d,g)}e("deleteMetadata",Pn);function Rn(l,d){for(var g=l.length-1;g>=0;--g){var y=l[g],x=y(d);if(!I(x)&&!nt(x)){if(!fe(x))throw new TypeError;d=x}}return d}function In(l,d,g,y){for(var x=l.length-1;x>=0;--x){var re=l[x],ae=re(d,g,y);if(!I(ae)&&!nt(ae)){if(!te(ae))throw new TypeError;y=ae}}return y}function er(l,d,g){var y=Bt(l,d,g);if(y)return!0;var x=Nt(d);return nt(x)?!1:er(l,x,g)}function Bt(l,d,g){var y=gt(d,g,!1);return I(y)?!1:_t(y.OrdinaryHasOwnMetadata(l,d,g))}function tr(l,d,g){var y=Bt(l,d,g);if(y)return rr(l,d,g);var x=Nt(d);if(!nt(x))return tr(l,x,g)}function rr(l,d,g){var y=gt(d,g,!1);if(!I(y))return y.OrdinaryGetOwnMetadata(l,d,g)}function nr(l,d,g,y){var x=gt(g,y,!0);x.OrdinaryDefineOwnMetadata(l,d,g,y)}function ir(l,d){var g=sr(l,d),y=Nt(l);if(y===null)return g;var x=ir(y,d);if(x.length<=0)return g;if(g.length<=0)return x;for(var re=new k,ae=[],U=0,_=g;U<_.length;U++){var w=_[U],O=re.has(w);O||(re.add(w),ae.push(w))}for(var L=0,V=x;L<V.length;L++){var w=V[L],O=re.has(w);O||(re.add(w),ae.push(w))}return ae}function sr(l,d){var g=gt(l,d,!1);return g?g.OrdinaryOwnMetadataKeys(l,d):[]}function or(l){if(l===null)return 1;switch(typeof l){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return l===null?1:6;default:return 6}}function I(l){return l===void 0}function nt(l){return l===null}function ar(l){return typeof l=="symbol"}function te(l){return typeof l=="object"?l!==null:typeof l=="function"}function Ie(l,d){switch(or(l)){case 0:return l;case 1:return l;case 2:return l;case 3:return l;case 4:return l;case 5:return l}var g=d===3?"string":d===5?"number":"default",y=ur(l,o);if(y!==void 0){var x=y.call(l,g);if(te(x))throw new TypeError;return x}return it(l,g==="default"?"number":g)}function it(l,d){if(d==="string"){var g=l.toString;if(st(g)){var y=g.call(l);if(!te(y))return y}var x=l.valueOf;if(st(x)){var y=x.call(l);if(!te(y))return y}}else{var x=l.valueOf;if(st(x)){var y=x.call(l);if(!te(y))return y}var re=l.toString;if(st(re)){var y=re.call(l);if(!te(y))return y}}throw new TypeError}function _t(l){return!!l}function Ve(l){return""+l}function z(l){var d=Ie(l,3);return ar(d)?d:Ve(d)}function Ft(l){return Array.isArray?Array.isArray(l):l instanceof Object?l instanceof Array:Object.prototype.toString.call(l)==="[object Array]"}function st(l){return typeof l=="function"}function fe(l){return typeof l=="function"}function Bn(l){switch(or(l)){case 3:return!0;case 4:return!0;default:return!1}}function jt(l,d){return l===d||l!==l&&d!==d}function ur(l,d){var g=l[d];if(g!=null){if(!st(g))throw new TypeError;return g}}function lr(l){var d=ur(l,c);if(!st(d))throw new TypeError;var g=d.call(l);if(!te(g))throw new TypeError;return g}function cr(l){return l.value}function Mt(l){var d=l.next();return d.done?!1:d}function dr(l){var d=l.return;d&&d.call(l)}function Nt(l){var d=Object.getPrototypeOf(l);if(typeof l!="function"||l===C||d!==C)return d;var g=l.prototype,y=g&&Object.getPrototypeOf(g);if(y==null||y===Object.prototype)return d;var x=y.constructor;return typeof x!="function"||x===l?d:x}function Fn(){var l;!I(_e)&&typeof t.Reflect<"u"&&!(_e in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(l=Nn(t.Reflect));var d,g,y,x=new se,re={registerProvider:ae,getProvider:_,setProvider:O};return re;function ae(L){if(!Object.isExtensible(re))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case l===L:break;case I(d):d=L;break;case d===L:break;case I(g):g=L;break;case g===L:break;default:y===void 0&&(y=new k),y.add(L);break}}function U(L,V){if(!I(d)){if(d.isProviderFor(L,V))return d;if(!I(g)){if(g.isProviderFor(L,V))return d;if(!I(y))for(var Q=lr(y);;){var ne=Mt(Q);if(!ne)return;var be=cr(ne);if(be.isProviderFor(L,V))return dr(Q),be}}}if(!I(l)&&l.isProviderFor(L,V))return l}function _(L,V){var Q=x.get(L),ne;return I(Q)||(ne=Q.get(V)),I(ne)&&(ne=U(L,V),I(ne)||(I(Q)&&(Q=new oe,x.set(L,Q)),Q.set(V,ne))),ne}function w(L){if(I(L))throw new TypeError;return d===L||g===L||!I(y)&&y.has(L)}function O(L,V,Q){if(!w(Q))throw new Error("Metadata provider not registered.");var ne=_(L,V);if(ne!==Q){if(!I(ne))return!1;var be=x.get(L);I(be)&&(be=new oe,x.set(L,be)),be.set(V,Q)}return!0}}function fr(){var l;return!I(_e)&&te(t.Reflect)&&Object.isExtensible(t.Reflect)&&(l=t.Reflect[_e]),I(l)&&(l=Fn()),!I(_e)&&te(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,_e,{enumerable:!1,configurable:!1,writable:!1,value:l}),l}function jn(l){var d=new se,g={isProviderFor:function(w,O){var L=d.get(w);return I(L)?!1:L.has(O)},OrdinaryDefineOwnMetadata:ae,OrdinaryHasOwnMetadata:x,OrdinaryGetOwnMetadata:re,OrdinaryOwnMetadataKeys:U,OrdinaryDeleteMetadata:_};return ze.registerProvider(g),g;function y(w,O,L){var V=d.get(w),Q=!1;if(I(V)){if(!L)return;V=new oe,d.set(w,V),Q=!0}var ne=V.get(O);if(I(ne)){if(!L)return;if(ne=new oe,V.set(O,ne),!l.setProvider(w,O,g))throw V.delete(O),Q&&d.delete(w),new Error("Wrong provider for target.")}return ne}function x(w,O,L){var V=y(O,L,!1);return I(V)?!1:_t(V.has(w))}function re(w,O,L){var V=y(O,L,!1);if(!I(V))return V.get(w)}function ae(w,O,L,V){var Q=y(L,V,!0);Q.set(w,O)}function U(w,O){var L=[],V=y(w,O,!1);if(I(V))return L;for(var Q=V.keys(),ne=lr(Q),be=0;;){var Ut=Mt(ne);if(!Ut)return L.length=be,L;var Vn=cr(Ut);try{L[be]=Vn}catch(Wn){try{dr(ne)}finally{throw Wn}}be++}}function _(w,O,L){var V=y(O,L,!1);if(I(V)||!V.delete(w))return!1;if(V.size===0){var Q=d.get(O);I(Q)||(Q.delete(L),Q.size===0&&d.delete(Q))}return!0}}function Nn(l){var d=l.defineMetadata,g=l.hasOwnMetadata,y=l.getOwnMetadata,x=l.getOwnMetadataKeys,re=l.deleteMetadata,ae=new se,U={isProviderFor:function(_,w){var O=ae.get(_);return!I(O)&&O.has(w)?!0:x(_,w).length?(I(O)&&(O=new k,ae.set(_,O)),O.add(w),!0):!1},OrdinaryDefineOwnMetadata:d,OrdinaryHasOwnMetadata:g,OrdinaryGetOwnMetadata:y,OrdinaryOwnMetadataKeys:x,OrdinaryDeleteMetadata:re};return U}function gt(l,d,g){var y=ze.getProvider(l,d);if(!I(y))return y;if(g){if(ze.setProvider(l,d,tt))return tt;throw new Error("Illegal state.")}}function kn(){var l={},d=[],g=function(){function U(_,w,O){this._index=0,this._keys=_,this._values=w,this._selector=O}return U.prototype["@@iterator"]=function(){return this},U.prototype[c]=function(){return this},U.prototype.next=function(){var _=this._index;if(_>=0&&_<this._keys.length){var w=this._selector(this._keys[_],this._values[_]);return _+1>=this._keys.length?(this._index=-1,this._keys=d,this._values=d):this._index++,{value:w,done:!1}}return{value:void 0,done:!0}},U.prototype.throw=function(_){throw this._index>=0&&(this._index=-1,this._keys=d,this._values=d),_},U.prototype.return=function(_){return this._index>=0&&(this._index=-1,this._keys=d,this._values=d),{value:_,done:!0}},U}(),y=function(){function U(){this._keys=[],this._values=[],this._cacheKey=l,this._cacheIndex=-2}return Object.defineProperty(U.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),U.prototype.has=function(_){return this._find(_,!1)>=0},U.prototype.get=function(_){var w=this._find(_,!1);return w>=0?this._values[w]:void 0},U.prototype.set=function(_,w){var O=this._find(_,!0);return this._values[O]=w,this},U.prototype.delete=function(_){var w=this._find(_,!1);if(w>=0){for(var O=this._keys.length,L=w+1;L<O;L++)this._keys[L-1]=this._keys[L],this._values[L-1]=this._values[L];return this._keys.length--,this._values.length--,jt(_,this._cacheKey)&&(this._cacheKey=l,this._cacheIndex=-2),!0}return!1},U.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=l,this._cacheIndex=-2},U.prototype.keys=function(){return new g(this._keys,this._values,x)},U.prototype.values=function(){return new g(this._keys,this._values,re)},U.prototype.entries=function(){return new g(this._keys,this._values,ae)},U.prototype["@@iterator"]=function(){return this.entries()},U.prototype[c]=function(){return this.entries()},U.prototype._find=function(_,w){if(!jt(this._cacheKey,_)){this._cacheIndex=-1;for(var O=0;O<this._keys.length;O++)if(jt(this._keys[O],_)){this._cacheIndex=O;break}}return this._cacheIndex<0&&w&&(this._cacheIndex=this._keys.length,this._keys.push(_),this._values.push(void 0)),this._cacheIndex},U}();return y;function x(U,_){return U}function re(U,_){return _}function ae(U,_){return[U,_]}}function Un(){var l=function(){function d(){this._map=new oe}return Object.defineProperty(d.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),d.prototype.has=function(g){return this._map.has(g)},d.prototype.add=function(g){return this._map.set(g,g),this},d.prototype.delete=function(g){return this._map.delete(g)},d.prototype.clear=function(){this._map.clear()},d.prototype.keys=function(){return this._map.keys()},d.prototype.values=function(){return this._map.keys()},d.prototype.entries=function(){return this._map.entries()},d.prototype["@@iterator"]=function(){return this.keys()},d.prototype[c]=function(){return this.keys()},d}();return l}function $n(){var l=16,d=D.create(),g=y();return function(){function _(){this._key=y()}return _.prototype.has=function(w){var O=x(w,!1);return O!==void 0?D.has(O,this._key):!1},_.prototype.get=function(w){var O=x(w,!1);return O!==void 0?D.get(O,this._key):void 0},_.prototype.set=function(w,O){var L=x(w,!0);return L[this._key]=O,this},_.prototype.delete=function(w){var O=x(w,!1);return O!==void 0?delete O[this._key]:!1},_.prototype.clear=function(){this._key=y()},_}();function y(){var _;do _="@@WeakMap@@"+U();while(D.has(d,_));return d[_]=!0,_}function x(_,w){if(!r.call(_,g)){if(!w)return;Object.defineProperty(_,g,{value:D.create()})}return _[g]}function re(_,w){for(var O=0;O<w;++O)_[O]=Math.random()*255|0;return _}function ae(_){if(typeof Uint8Array=="function"){var w=new Uint8Array(_);return typeof crypto<"u"?crypto.getRandomValues(w):typeof msCrypto<"u"?msCrypto.getRandomValues(w):re(w,_),w}return re(new Array(_),_)}function U(){var _=ae(l);_[6]=_[6]&79|64,_[8]=_[8]&191|128;for(var w="",O=0;O<l;++O){var L=_[O];(O===4||O===6||O===8)&&(w+="-"),L<16&&(w+="0"),w+=L.toString(16).toLowerCase()}return w}}function kt(l){return l.__=void 0,delete l.__,l}})})(oo||(oo={}))});var dt=P(v=>{"use strict";var Oi=v&&v.__decorate||function(n,e,t,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,r);else for(var h=n.length-1;h>=0;h--)(c=n[h])&&(o=(i<3?c(o):i>3?c(e,t,o):c(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},Li=v&&v.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(v,"__esModule",{value:!0});v.RawReading=v.RawUnsubscribeCmd=v.RawSubscribeCmd=v.RawWriteCmd=v.RawReadCmd=v.SensorReading=v.SensorReadCmd=v.LinearCmd=v.VectorSubcommand=v.RotateCmd=v.RotateSubcommand=v.ScalarCmd=v.ScalarSubcommand=v.GenericMessageSubcommand=v.StopAllDevices=v.StopDeviceCmd=v.ServerInfo=v.RequestServerInfo=v.ScanningFinished=v.StopScanning=v.StartScanning=v.RequestDeviceList=v.DeviceRemoved=v.DeviceAdded=v.DeviceList=v.DeviceInfo=v.Error=v.ErrorClass=v.Ping=v.Ok=v.ButtplugSystemMessage=v.ButtplugDeviceMessage=v.ButtplugMessage=v.SensorDeviceMessageAttributes=v.RawDeviceMessageAttributes=v.GenericDeviceMessageAttributes=v.SensorType=v.ActuatorType=v.MessageAttributes=v.MESSAGE_SPEC_VERSION=v.MAX_ID=v.DEFAULT_MESSAGE_ID=v.SYSTEM_MESSAGE_ID=void 0;var ln=Si();ao();v.SYSTEM_MESSAGE_ID=0;v.DEFAULT_MESSAGE_ID=1;v.MAX_ID=4294967295;v.MESSAGE_SPEC_VERSION=3;var St=class{constructor(e){Object.assign(this,e)}update(){var e,t,r,i,o;(e=this.ScalarCmd)===null||e===void 0||e.forEach((c,h)=>c.Index=h),(t=this.RotateCmd)===null||t===void 0||t.forEach((c,h)=>c.Index=h),(r=this.LinearCmd)===null||r===void 0||r.forEach((c,h)=>c.Index=h),(i=this.SensorReadCmd)===null||i===void 0||i.forEach((c,h)=>c.Index=h),(o=this.SensorSubscribeCmd)===null||o===void 0||o.forEach((c,h)=>c.Index=h)}};v.MessageAttributes=St;var uo;(function(n){n.Unknown="Unknown",n.Vibrate="Vibrate",n.Rotate="Rotate",n.Oscillate="Oscillate",n.Constrict="Constrict",n.Inflate="Inflate",n.Position="Position"})(uo||(v.ActuatorType=uo={}));var lo;(function(n){n.Unknown="Unknown",n.Battery="Battery",n.RSSI="RSSI",n.Button="Button",n.Pressure="Pressure"})(lo||(v.SensorType=lo={}));var _i=class{constructor(e){this.Index=0,Object.assign(this,e)}};v.GenericDeviceMessageAttributes=_i;var Mi=class{constructor(e){this.Endpoints=e}};v.RawDeviceMessageAttributes=Mi;var wi=class{constructor(e){this.Index=0,Object.assign(this,e)}};v.SensorDeviceMessageAttributes=wi;var Fe=class{constructor(e){this.Id=e}get Type(){return this.constructor}toJSON(){return JSON.stringify(this.toProtocolFormat())}toProtocolFormat(){let e={};return e[this.constructor.Name]=(0,ln.instanceToPlain)(this),e}update(){}};v.ButtplugMessage=Fe;var Re=class extends Fe{constructor(e,t){super(t),this.DeviceIndex=e,this.Id=t}};v.ButtplugDeviceMessage=Re;var ct=class extends Fe{constructor(e=v.SYSTEM_MESSAGE_ID){super(e),this.Id=e}};v.ButtplugSystemMessage=ct;var Ur=class extends ct{constructor(e=v.DEFAULT_MESSAGE_ID){super(e),this.Id=e}};v.Ok=Ur;Ur.Name="Ok";var $r=class extends Fe{constructor(e=v.DEFAULT_MESSAGE_ID){super(e),this.Id=e}};v.Ping=$r;$r.Name="Ping";var Ti;(function(n){n[n.ERROR_UNKNOWN=0]="ERROR_UNKNOWN",n[n.ERROR_INIT=1]="ERROR_INIT",n[n.ERROR_PING=2]="ERROR_PING",n[n.ERROR_MSG=3]="ERROR_MSG",n[n.ERROR_DEVICE=4]="ERROR_DEVICE"})(Ti||(v.ErrorClass=Ti={}));var Vr=class extends Fe{constructor(e,t=Ti.ERROR_UNKNOWN,r=v.DEFAULT_MESSAGE_ID){super(r),this.ErrorMessage=e,this.ErrorCode=t,this.Id=r}get Schemversion(){return 0}};v.Error=Vr;Vr.Name="Error";var Jt=class{constructor(e){Object.assign(this,e)}};v.DeviceInfo=Jt;Oi([(0,ln.Type)(()=>St),Li("design:type",St)],Jt.prototype,"DeviceMessages",void 0);var Yt=class extends Fe{constructor(e,t=v.DEFAULT_MESSAGE_ID){super(t),this.Devices=e,this.Id=t}update(){for(let e of this.Devices)e.DeviceMessages.update()}};v.DeviceList=Yt;Yt.Name="DeviceList";Oi([(0,ln.Type)(()=>Jt),Li("design:type",Array)],Yt.prototype,"Devices",void 0);var Kt=class extends ct{constructor(e){super(),Object.assign(this,e)}update(){this.DeviceMessages.update()}};v.DeviceAdded=Kt;Kt.Name="DeviceAdded";Oi([(0,ln.Type)(()=>St),Li("design:type",St)],Kt.prototype,"DeviceMessages",void 0);var Wr=class extends ct{constructor(e){super(),this.DeviceIndex=e}};v.DeviceRemoved=Wr;Wr.Name="DeviceRemoved";var Hr=class extends Fe{constructor(e=v.DEFAULT_MESSAGE_ID){super(e),this.Id=e}};v.RequestDeviceList=Hr;Hr.Name="RequestDeviceList";var qr=class extends Fe{constructor(e=v.DEFAULT_MESSAGE_ID){super(e),this.Id=e}};v.StartScanning=qr;qr.Name="StartScanning";var Gr=class extends Fe{constructor(e=v.DEFAULT_MESSAGE_ID){super(e),this.Id=e}};v.StopScanning=Gr;Gr.Name="StopScanning";var zr=class extends ct{constructor(){super()}};v.ScanningFinished=zr;zr.Name="ScanningFinished";var Jr=class extends Fe{constructor(e,t=0,r=v.DEFAULT_MESSAGE_ID){super(r),this.ClientName=e,this.MessageVersion=t,this.Id=r}};v.RequestServerInfo=Jr;Jr.Name="RequestServerInfo";var Yr=class extends ct{constructor(e,t,r,i=v.DEFAULT_MESSAGE_ID){super(),this.MessageVersion=e,this.MaxPingTime=t,this.ServerName=r,this.Id=i}};v.ServerInfo=Yr;Yr.Name="ServerInfo";var Kr=class extends Re{constructor(e=-1,t=v.DEFAULT_MESSAGE_ID){super(e,t),this.DeviceIndex=e,this.Id=t}};v.StopDeviceCmd=Kr;Kr.Name="StopDeviceCmd";var Xr=class extends Fe{constructor(e=v.DEFAULT_MESSAGE_ID){super(e),this.Id=e}};v.StopAllDevices=Xr;Xr.Name="StopAllDevices";var At=class{constructor(e){this.Index=e}};v.GenericMessageSubcommand=At;var Ei=class extends At{constructor(e,t,r){super(e),this.Scalar=t,this.ActuatorType=r}};v.ScalarSubcommand=Ei;var Zr=class extends Re{constructor(e,t=-1,r=v.DEFAULT_MESSAGE_ID){super(t,r),this.Scalars=e,this.DeviceIndex=t,this.Id=r}};v.ScalarCmd=Zr;Zr.Name="ScalarCmd";var Qr=class extends At{constructor(e,t,r){super(e),this.Speed=t,this.Clockwise=r}};v.RotateSubcommand=Qr;var xt=class extends Re{static Create(e,t){let r=new Array,i=0;for(let[o,c]of t)r.push(new Qr(i,o,c)),++i;return new xt(r,e)}constructor(e,t=-1,r=v.DEFAULT_MESSAGE_ID){super(t,r),this.Rotations=e,this.DeviceIndex=t,this.Id=r}};v.RotateCmd=xt;xt.Name="RotateCmd";var en=class extends At{constructor(e,t,r){super(e),this.Position=t,this.Duration=r}};v.VectorSubcommand=en;var Pt=class extends Re{static Create(e,t){let r=new Array,i=0;for(let o of t)r.push(new en(i,o[0],o[1])),++i;return new Pt(r,e)}constructor(e,t=-1,r=v.DEFAULT_MESSAGE_ID){super(t,r),this.Vectors=e,this.DeviceIndex=t,this.Id=r}};v.LinearCmd=Pt;Pt.Name="LinearCmd";var tn=class extends Re{constructor(e,t,r,i=v.DEFAULT_MESSAGE_ID){super(e,i),this.DeviceIndex=e,this.SensorIndex=t,this.SensorType=r,this.Id=i}};v.SensorReadCmd=tn;tn.Name="SensorReadCmd";var rn=class extends Re{constructor(e,t,r,i,o=v.DEFAULT_MESSAGE_ID){super(e,o),this.DeviceIndex=e,this.SensorIndex=t,this.SensorType=r,this.Data=i,this.Id=o}};v.SensorReading=rn;rn.Name="SensorReading";var nn=class extends Re{constructor(e,t,r,i,o=v.DEFAULT_MESSAGE_ID){super(e,o),this.DeviceIndex=e,this.Endpoint=t,this.ExpectedLength=r,this.Timeout=i,this.Id=o}};v.RawReadCmd=nn;nn.Name="RawReadCmd";var sn=class extends Re{constructor(e,t,r,i,o=v.DEFAULT_MESSAGE_ID){super(e,o),this.DeviceIndex=e,this.Endpoint=t,this.Data=r,this.WriteWithResponse=i,this.Id=o}};v.RawWriteCmd=sn;sn.Name="RawWriteCmd";var on=class extends Re{constructor(e,t,r=v.DEFAULT_MESSAGE_ID){super(e,r),this.DeviceIndex=e,this.Endpoint=t,this.Id=r}};v.RawSubscribeCmd=on;on.Name="RawSubscribeCmd";var an=class extends Re{constructor(e,t,r=v.DEFAULT_MESSAGE_ID){super(e,r),this.DeviceIndex=e,this.Endpoint=t,this.Id=r}};v.RawUnsubscribeCmd=an;an.Name="RawUnsubscribeCmd";var un=class extends Re{constructor(e,t,r,i=v.DEFAULT_MESSAGE_ID){super(e,i),this.DeviceIndex=e,this.Endpoint=t,this.Data=r,this.Id=i}};v.RawReading=un;un.Name="RawReading"});var Rt=P(he=>{"use strict";var Xa=he&&he.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Za=he&&he.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Qa=he&&he.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Xa(e,n,t);return Za(e,n),e};Object.defineProperty(he,"__esModule",{value:!0});he.ButtplugUnknownError=he.ButtplugPingError=he.ButtplugMessageError=he.ButtplugDeviceError=he.ButtplugInitError=he.ButtplugError=void 0;var ve=Qa(dt()),ft=class extends Error{get ErrorClass(){return this.errorClass}get InnerError(){return this.innerError}get Id(){return this.messageId}get ErrorMessage(){return new ve.Error(this.message,this.ErrorClass,this.Id)}static LogAndError(e,t,r,i=ve.SYSTEM_MESSAGE_ID){return t.Error(r),new e(r,i)}static FromError(e){switch(e.ErrorCode){case ve.ErrorClass.ERROR_DEVICE:return new dn(e.ErrorMessage,e.Id);case ve.ErrorClass.ERROR_INIT:return new cn(e.ErrorMessage,e.Id);case ve.ErrorClass.ERROR_UNKNOWN:return new hn(e.ErrorMessage,e.Id);case ve.ErrorClass.ERROR_PING:return new pn(e.ErrorMessage,e.Id);case ve.ErrorClass.ERROR_MSG:return new fn(e.ErrorMessage,e.Id);default:throw new Error(`Message type ${e.ErrorCode} not handled`)}}constructor(e,t,r=ve.SYSTEM_MESSAGE_ID,i){super(e),this.errorClass=ve.ErrorClass.ERROR_UNKNOWN,this.errorClass=t,this.innerError=i,this.messageId=r}};he.ButtplugError=ft;var cn=class extends ft{constructor(e,t=ve.SYSTEM_MESSAGE_ID){super(e,ve.ErrorClass.ERROR_INIT,t)}};he.ButtplugInitError=cn;var dn=class extends ft{constructor(e,t=ve.SYSTEM_MESSAGE_ID){super(e,ve.ErrorClass.ERROR_DEVICE,t)}};he.ButtplugDeviceError=dn;var fn=class extends ft{constructor(e,t=ve.SYSTEM_MESSAGE_ID){super(e,ve.ErrorClass.ERROR_MSG,t)}};he.ButtplugMessageError=fn;var pn=class extends ft{constructor(e,t=ve.SYSTEM_MESSAGE_ID){super(e,ve.ErrorClass.ERROR_PING,t)}};he.ButtplugPingError=pn;var hn=class extends ft{constructor(e,t=ve.SYSTEM_MESSAGE_ID){super(e,ve.ErrorClass.ERROR_UNKNOWN,t)}};he.ButtplugUnknownError=hn});var Xt=P(Ne=>{"use strict";var eu=Ne&&Ne.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),tu=Ne&&Ne.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),ru=Ne&&Ne.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&eu(e,n,t);return tu(e,n),e};Object.defineProperty(Ne,"__esModule",{value:!0});Ne.fromJSON=Ne.getMessageClassFromMessage=void 0;var nu=Si(),iu=ru(dt());function co(n){for(let e of Object.values(iu))if(typeof e=="function"&&"Name"in e&&e.Name===n)return e;return null}function su(n){return co(Object.getPrototypeOf(n).constructor.Name)}Ne.getMessageClassFromMessage=su;function ou(n){let e=JSON.parse(n),t=[];for(let r of Array.from(e)){let i=Object.getOwnPropertyNames(r)[0],o=co(i);if(o){let c=(0,nu.plainToInstance)(o,r[i]);c.update(),t.push(c)}}return t}Ne.fromJSON=ou});var Di=P(ke=>{"use strict";var au=ke&&ke.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),uu=ke&&ke.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),lu=ke&&ke.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&au(e,n,t);return uu(e,n),e},Te=ke&&ke.__awaiter||function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(D){try{S(r.next(D))}catch(C){c(C)}}function p(D){try{S(r.throw(D))}catch(C){c(C)}}function S(D){D.done?o(D.value):i(D.value).then(h,p)}S((r=r.apply(n,e||[])).next())})};Object.defineProperty(ke,"__esModule",{value:!0});ke.ButtplugClientDevice=void 0;var X=lu(dt()),ie=Rt(),cu=qt(),Ci=Xt(),Zt=class extends cu.EventEmitter{get name(){return this._deviceInfo.DeviceName}get displayName(){return this._deviceInfo.DeviceDisplayName}get index(){return this._deviceInfo.DeviceIndex}get messageTimingGap(){return this._deviceInfo.DeviceMessageTimingGap}get messageAttributes(){return this._deviceInfo.DeviceMessages}static fromMsg(e,t){return new Zt(e,t)}constructor(e,t){super(),this._deviceInfo=e,this._sendClosure=t,this.allowedMsgs=new Map,e.DeviceMessages.update()}send(e){return Te(this,void 0,void 0,function*(){return yield this._sendClosure(this,e)})}sendExpectOk(e){return Te(this,void 0,void 0,function*(){let t=yield this.send(e);switch((0,Ci.getMessageClassFromMessage)(t)){case X.Ok:return;case X.Error:throw ie.ButtplugError.FromError(t);default:throw new ie.ButtplugMessageError(`Message type ${t.constructor} not handled by SendMsgExpectOk`)}})}scalar(e){return Te(this,void 0,void 0,function*(){Array.isArray(e)?yield this.sendExpectOk(new X.ScalarCmd(e,this.index)):yield this.sendExpectOk(new X.ScalarCmd([e],this.index))})}scalarCommandBuilder(e,t){var r;return Te(this,void 0,void 0,function*(){let i=(r=this.messageAttributes.ScalarCmd)===null||r===void 0?void 0:r.filter(c=>c.ActuatorType===t);if(!i||i.length===0)throw new ie.ButtplugDeviceError(`Device ${this.name} has no ${t} capabilities`);let o=[];if(typeof e=="number")i.forEach(c=>o.push(new X.ScalarSubcommand(c.Index,e,t)));else if(Array.isArray(e)){if(e.length>i.length)throw new ie.ButtplugDeviceError(`${e.length} commands send to a device with ${i.length} vibrators`);i.forEach((c,h)=>{o.push(new X.ScalarSubcommand(c.Index,e[h],t))})}else throw new ie.ButtplugDeviceError(`${t} can only take numbers or arrays of numbers.`);yield this.scalar(o)})}get vibrateAttributes(){var e,t;return(t=(e=this.messageAttributes.ScalarCmd)===null||e===void 0?void 0:e.filter(r=>r.ActuatorType===X.ActuatorType.Vibrate))!==null&&t!==void 0?t:[]}vibrate(e){return Te(this,void 0,void 0,function*(){yield this.scalarCommandBuilder(e,X.ActuatorType.Vibrate)})}get oscillateAttributes(){var e,t;return(t=(e=this.messageAttributes.ScalarCmd)===null||e===void 0?void 0:e.filter(r=>r.ActuatorType===X.ActuatorType.Oscillate))!==null&&t!==void 0?t:[]}oscillate(e){return Te(this,void 0,void 0,function*(){yield this.scalarCommandBuilder(e,X.ActuatorType.Oscillate)})}get rotateAttributes(){var e;return(e=this.messageAttributes.RotateCmd)!==null&&e!==void 0?e:[]}rotate(e,t){return Te(this,void 0,void 0,function*(){let r=this.messageAttributes.RotateCmd;if(!r||r.length===0)throw new ie.ButtplugDeviceError(`Device ${this.name} has no Rotate capabilities`);let i;if(typeof e=="number")i=X.RotateCmd.Create(this.index,new Array(r.length).fill([e,t]));else if(Array.isArray(e))i=X.RotateCmd.Create(this.index,e);else throw new ie.ButtplugDeviceError("SendRotateCmd can only take a number and boolean, or an array of number/boolean tuples");yield this.sendExpectOk(i)})}get linearAttributes(){var e;return(e=this.messageAttributes.LinearCmd)!==null&&e!==void 0?e:[]}linear(e,t){return Te(this,void 0,void 0,function*(){let r=this.messageAttributes.LinearCmd;if(!r||r.length===0)throw new ie.ButtplugDeviceError(`Device ${this.name} has no Linear capabilities`);let i;if(typeof e=="number")i=X.LinearCmd.Create(this.index,new Array(r.length).fill([e,t]));else if(Array.isArray(e))i=X.LinearCmd.Create(this.index,e);else throw new ie.ButtplugDeviceError("SendLinearCmd can only take a number and number, or an array of number/number tuples");yield this.sendExpectOk(i)})}sensorRead(e,t){return Te(this,void 0,void 0,function*(){let r=yield this.send(new X.SensorReadCmd(this.index,e,t));switch((0,Ci.getMessageClassFromMessage)(r)){case X.SensorReading:return r.Data;case X.Error:throw ie.ButtplugError.FromError(r);default:throw new ie.ButtplugMessageError(`Message type ${r.constructor} not handled by sensorRead`)}})}get hasBattery(){var e;let t=(e=this.messageAttributes.SensorReadCmd)===null||e===void 0?void 0:e.filter(r=>r.SensorType===X.SensorType.Battery);return t!==void 0&&t.length>0}battery(){var e;return Te(this,void 0,void 0,function*(){if(!this.hasBattery)throw new ie.ButtplugDeviceError(`Device ${this.name} has no Battery capabilities`);let t=(e=this.messageAttributes.SensorReadCmd)===null||e===void 0?void 0:e.filter(i=>i.SensorType===X.SensorType.Battery);return(yield this.sensorRead(t[0].Index,X.SensorType.Battery))[0]/100})}get hasRssi(){var e;let t=(e=this.messageAttributes.SensorReadCmd)===null||e===void 0?void 0:e.filter(r=>r.SensorType===X.SensorType.RSSI);return t!==void 0&&t.length===0}rssi(){var e;return Te(this,void 0,void 0,function*(){if(!this.hasRssi)throw new ie.ButtplugDeviceError(`Device ${this.name} has no RSSI capabilities`);let t=(e=this.messageAttributes.SensorReadCmd)===null||e===void 0?void 0:e.filter(i=>i.SensorType===X.SensorType.RSSI);return(yield this.sensorRead(t[0].Index,X.SensorType.RSSI))[0]})}rawRead(e,t,r){return Te(this,void 0,void 0,function*(){if(!this.messageAttributes.RawReadCmd)throw new ie.ButtplugDeviceError(`Device ${this.name} has no raw read capabilities`);if(this.messageAttributes.RawReadCmd.Endpoints.indexOf(e)===-1)throw new ie.ButtplugDeviceError(`Device ${this.name} has no raw readable endpoint ${e}`);let i=yield this.send(new X.RawReadCmd(this.index,e,t,r));switch((0,Ci.getMessageClassFromMessage)(i)){case X.RawReading:return new Uint8Array(i.Data);case X.Error:throw ie.ButtplugError.FromError(i);default:throw new ie.ButtplugMessageError(`Message type ${i.constructor} not handled by rawRead`)}})}rawWrite(e,t,r){return Te(this,void 0,void 0,function*(){if(!this.messageAttributes.RawWriteCmd)throw new ie.ButtplugDeviceError(`Device ${this.name} has no raw write capabilities`);if(this.messageAttributes.RawWriteCmd.Endpoints.indexOf(e)===-1)throw new ie.ButtplugDeviceError(`Device ${this.name} has no raw writable endpoint ${e}`);yield this.sendExpectOk(new X.RawWriteCmd(this.index,e,t,r))})}rawSubscribe(e){return Te(this,void 0,void 0,function*(){if(!this.messageAttributes.RawSubscribeCmd)throw new ie.ButtplugDeviceError(`Device ${this.name} has no raw subscribe capabilities`);if(this.messageAttributes.RawSubscribeCmd.Endpoints.indexOf(e)===-1)throw new ie.ButtplugDeviceError(`Device ${this.name} has no raw subscribable endpoint ${e}`);yield this.sendExpectOk(new X.RawSubscribeCmd(this.index,e))})}rawUnsubscribe(e){return Te(this,void 0,void 0,function*(){if(!this.messageAttributes.RawSubscribeCmd)throw new ie.ButtplugDeviceError(`Device ${this.name} has no raw unsubscribe capabilities`);if(this.messageAttributes.RawSubscribeCmd.Endpoints.indexOf(e)===-1)throw new ie.ButtplugDeviceError(`Device ${this.name} has no raw unsubscribable endpoint ${e}`);yield this.sendExpectOk(new X.RawUnsubscribeCmd(this.index,e))})}stop(){return Te(this,void 0,void 0,function*(){yield this.sendExpectOk(new X.StopDeviceCmd(this.index))})}emitDisconnected(){this.emit("deviceremoved")}};ke.ButtplugClientDevice=Zt});var xi=P(Ke=>{"use strict";var du=Ke&&Ke.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),fu=Ke&&Ke.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),pu=Ke&&Ke.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&du(e,n,t);return fu(e,n),e};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.ButtplugMessageSorter=void 0;var fo=pu(dt()),hu=Rt(),Ai=class{constructor(e){this._useCounter=e,this._counter=1,this._waitingMsgs=new Map}PrepareOutgoingMessage(e){this._useCounter&&(e.Id=this._counter,this._counter+=1);let t,r,i=new Promise((o,c)=>{t=o,r=c});return this._waitingMsgs.set(e.Id,[t,r]),i}ParseIncomingMessages(e){let t=[];for(let r of e)if(r.Id!==fo.SYSTEM_MESSAGE_ID&&this._waitingMsgs.has(r.Id)){let[i,o]=this._waitingMsgs.get(r.Id);if(r.Type===fo.Error){o(hu.ButtplugError.FromError(r));continue}i(r);continue}else t.push(r);return t}};Ke.ButtplugMessageSorter=Ai});var Ri=P(Xe=>{"use strict";var gu=Xe&&Xe.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),vu=Xe&&Xe.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),mu=Xe&&Xe.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&gu(e,n,t);return vu(e,n),e};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.ButtplugClientConnectorException=void 0;var bu=Rt(),yu=mu(dt()),Pi=class extends bu.ButtplugError{constructor(e){super(e,yu.ErrorClass.ERROR_UNKNOWN)}};Xe.ButtplugClientConnectorException=Pi});var ho=P($e=>{"use strict";var Su=$e&&$e.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),_u=$e&&$e.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Mu=$e&&$e.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Su(e,n,t);return _u(e,n),e},Ue=$e&&$e.__awaiter||function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(D){try{S(r.next(D))}catch(C){c(C)}}function p(D){try{S(r.throw(D))}catch(C){c(C)}}function S(D){D.done?o(D.value):i(D.value).then(h,p)}S((r=r.apply(n,e||[])).next())})};Object.defineProperty($e,"__esModule",{value:!0});$e.ButtplugClient=void 0;var wu=gi(),Tu=qt(),po=Di(),Eu=xi(),Oe=Mu(dt()),Qe=Rt(),Ou=Ri(),gn=Xt(),Ii=class extends Tu.EventEmitter{constructor(e="Generic Buttplug Client"){super(),this._pingTimer=null,this._connector=null,this._devices=new Map,this._logger=wu.ButtplugLogger.Logger,this._isScanning=!1,this._sorter=new Eu.ButtplugMessageSorter(!0),this.connect=t=>Ue(this,void 0,void 0,function*(){this._logger.Info(`ButtplugClient: Connecting using ${t.constructor.name}`),yield t.connect(),this._connector=t,this._connector.addListener("message",this.parseMessages),this._connector.addListener("disconnect",this.disconnectHandler),yield this.initializeConnection()}),this.disconnect=()=>Ue(this,void 0,void 0,function*(){this._logger.Debug("ButtplugClient: Disconnect called"),this.checkConnector(),yield this.shutdownConnection(),yield this._connector.disconnect()}),this.startScanning=()=>Ue(this,void 0,void 0,function*(){this._logger.Debug("ButtplugClient: StartScanning called"),this._isScanning=!0,yield this.sendMsgExpectOk(new Oe.StartScanning)}),this.stopScanning=()=>Ue(this,void 0,void 0,function*(){this._logger.Debug("ButtplugClient: StopScanning called"),this._isScanning=!1,yield this.sendMsgExpectOk(new Oe.StopScanning)}),this.stopAllDevices=()=>Ue(this,void 0,void 0,function*(){this._logger.Debug("ButtplugClient: StopAllDevices"),yield this.sendMsgExpectOk(new Oe.StopAllDevices)}),this.disconnectHandler=()=>{this._logger.Info("ButtplugClient: Disconnect event receieved."),this.emit("disconnect")},this.parseMessages=t=>{let r=this._sorter.ParseIncomingMessages(t);for(let i of r)switch((0,gn.getMessageClassFromMessage)(i)){case Oe.DeviceAdded:{let o=i,c=po.ButtplugClientDevice.fromMsg(o,this.sendDeviceMessageClosure);this._devices.set(o.DeviceIndex,c),this.emit("deviceadded",c);break}case Oe.DeviceRemoved:{let o=i;if(this._devices.has(o.DeviceIndex)){let c=this._devices.get(o.DeviceIndex);c?.emitDisconnected(),this._devices.delete(o.DeviceIndex),this.emit("deviceremoved",c)}break}case Oe.ScanningFinished:this._isScanning=!1,this.emit("scanningfinished",i);break}},this.initializeConnection=()=>Ue(this,void 0,void 0,function*(){this.checkConnector();let t=yield this.sendMessage(new Oe.RequestServerInfo(this._clientName,Oe.MESSAGE_SPEC_VERSION));switch((0,gn.getMessageClassFromMessage)(t)){case Oe.ServerInfo:{let r=t;this._logger.Info(`ButtplugClient: Connected to Server ${r.ServerName}`);let i=r.MaxPingTime;if(r.MessageVersion<Oe.MESSAGE_SPEC_VERSION)throw yield this._connector.disconnect(),Qe.ButtplugError.LogAndError(Qe.ButtplugInitError,this._logger,`Server protocol version ${r.MessageVersion} is older than client protocol version ${Oe.MESSAGE_SPEC_VERSION}. Please update server.`);return i>0,yield this.requestDeviceList(),!0}case Oe.Error:{yield this._connector.disconnect();let r=t;throw Qe.ButtplugError.LogAndError(Qe.ButtplugInitError,this._logger,`Cannot connect to server. ${r.ErrorMessage}`)}}return!1}),this.requestDeviceList=()=>Ue(this,void 0,void 0,function*(){this.checkConnector(),this._logger.Debug("ButtplugClient: ReceiveDeviceList called"),(yield this.sendMessage(new Oe.RequestDeviceList)).Devices.forEach(r=>{if(this._devices.has(r.DeviceIndex))this._logger.Debug(`ButtplugClient: Device already added: ${r}`);else{let i=po.ButtplugClientDevice.fromMsg(r,this.sendDeviceMessageClosure);this._logger.Debug(`ButtplugClient: Adding Device: ${i}`),this._devices.set(r.DeviceIndex,i),this.emit("deviceadded",i)}})}),this.shutdownConnection=()=>Ue(this,void 0,void 0,function*(){yield this.stopAllDevices(),this._pingTimer!==null&&(clearInterval(this._pingTimer),this._pingTimer=null)}),this.sendMsgExpectOk=t=>Ue(this,void 0,void 0,function*(){let r=yield this.sendMessage(t);switch((0,gn.getMessageClassFromMessage)(r)){case Oe.Ok:return;case Oe.Error:throw Qe.ButtplugError.FromError(r);default:throw Qe.ButtplugError.LogAndError(Qe.ButtplugMessageError,this._logger,`Message type ${(0,gn.getMessageClassFromMessage)(r).constructor} not handled by SendMsgExpectOk`)}}),this.sendDeviceMessageClosure=(t,r)=>Ue(this,void 0,void 0,function*(){return yield this.sendDeviceMessage(t,r)}),this._clientName=e,this._logger.Debug(`ButtplugClient: Client ${e} created.`)}get connected(){return this._connector!==null&&this._connector.Connected}get devices(){this.checkConnector();let e=[];return this._devices.forEach(t=>{e.push(t)}),e}get isScanning(){return this._isScanning}sendDeviceMessage(e,t){return Ue(this,void 0,void 0,function*(){if(this.checkConnector(),this._devices.get(e.index)===void 0)throw Qe.ButtplugError.LogAndError(Qe.ButtplugDeviceError,this._logger,`Device ${e.index} not available.`);return t.DeviceIndex=e.index,yield this.sendMessage(t)})}sendMessage(e){return Ue(this,void 0,void 0,function*(){this.checkConnector();let t=this._sorter.PrepareOutgoingMessage(e);return yield this._connector.send(e),yield t})}checkConnector(){if(!this.connected)throw new Ou.ButtplugClientConnectorException("ButtplugClient not connected")}};$e.ButtplugClient=Ii});var vo=P(It=>{"use strict";var vn=It&&It.__awaiter||function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(D){try{S(r.next(D))}catch(C){c(C)}}function p(D){try{S(r.throw(D))}catch(C){c(C)}}function S(D){D.done?o(D.value):i(D.value).then(h,p)}S((r=r.apply(n,e||[])).next())})};Object.defineProperty(It,"__esModule",{value:!0});It.ButtplugBrowserWebsocketConnector=void 0;var Lu=qt(),go=Xt(),Bi=class extends Lu.EventEmitter{constructor(e){super(),this._url=e,this._websocketConstructor=null,this.connect=()=>vn(this,void 0,void 0,function*(){var t;let r=new((t=this._websocketConstructor)!==null&&t!==void 0?t:WebSocket)(this._url),i,o,c=new Promise((p,S)=>{i=p,o=S}),h=()=>o();return r.addEventListener("open",()=>vn(this,void 0,void 0,function*(){this._ws=r;try{yield this.initialize(),this._ws.addEventListener("message",p=>{this.parseIncomingMessage(p)}),this._ws.removeEventListener("close",h),this._ws.addEventListener("close",this.disconnect),i()}catch(p){console.log(p),o()}})),r.addEventListener("close",h),c}),this.disconnect=()=>vn(this,void 0,void 0,function*(){this.Connected&&(this._ws.close(),this._ws=void 0,this.emit("disconnect"))}),this.initialize=()=>vn(this,void 0,void 0,function*(){return Promise.resolve()})}get Connected(){return this._ws!==void 0}sendMessage(e){if(!this.Connected)throw new Error("ButtplugBrowserWebsocketConnector not connected");this._ws.send("["+e.toJSON()+"]")}parseIncomingMessage(e){if(typeof e.data=="string"){let t=(0,go.fromJSON)(e.data);this.emit("message",t)}else e.data instanceof Blob}onReaderLoad(e){let t=(0,go.fromJSON)(e.target.result);this.emit("message",t)}};It.ButtplugBrowserWebsocketConnector=Bi});var ji=P(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.ButtplugBrowserWebsocketClientConnector=void 0;var Cu=vo(),Fi=class extends Cu.ButtplugBrowserWebsocketConnector{constructor(){super(...arguments),this.send=e=>{if(!this.Connected)throw new Error("ButtplugClient not connected");this.sendMessage(e)}}};mn.ButtplugBrowserWebsocketClientConnector=Fi});var bo=P((kl,mo)=>{"use strict";mo.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var yo=P(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.ButtplugNodeWebsocketClientConnector=void 0;var Du=ji(),Au=bo(),Ni=class extends Du.ButtplugBrowserWebsocketClientConnector{constructor(){super(...arguments),this._websocketConstructor=Au.WebSocket}};bn.ButtplugNodeWebsocketClientConnector=Ni});var _o=P(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0})});var Mo=P(Se=>{"use strict";var xu=Se&&Se.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),qe=Se&&Se.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&xu(e,n,t)};Object.defineProperty(Se,"__esModule",{value:!0});qe(ho(),Se);qe(Di(),Se);qe(ji(),Se);qe(yo(),Se);qe(Ri(),Se);qe(xi(),Se);qe(_o(),Se);qe(dt(),Se);qe(Xt(),Se);qe(gi(),Se);qe(Rt(),Se)});var Bo=P(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.roundAction=et.getSpeed=et.getActionGroups=void 0;var Fu=function(n){var e=[],t=-1,r=-1;return n.forEach(function(i,o){if(o===0){e.push([i]),t++;return}if(o===1){e[t].push(i),r=Math.max(250,i.at-n[o-1].at);return}var c=i.at-n[o-1].at;c>5*r?(e.push([i]),t++):e[t].push(i),r=Math.max(250,c)}),e};et.getActionGroups=Fu;var ju=function(n,e){if(!n||!e||n.at===e.at)return 0;try{if(e.at<n.at){var t=e;e=n,n=t}return 1e3*(Math.abs(e.pos-n.pos)/Math.abs(e.at-n.at))}catch(r){return console.error("Failed on actions",n,e,r),0}};et.getSpeed=ju;var Nu=function(n){var e={at:Math.max(0,Math.round(n.at)),pos:Math.max(0,Math.min(100,Math.round(n.pos)))};return n.subActions&&(e.subActions=n.subActions.map(function(t){return et.roundAction(t)})),n.type&&(e.type=n.type),e};et.roundAction=Nu});var Fo=P(Ge=>{"use strict";var Qt=Ge&&Ge.__assign||function(){return Qt=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Qt.apply(this,arguments)};Object.defineProperty(Ge,"__esModule",{value:!0});Ge.convertFunscriptToCsv=Ge.addFunscriptMetadata=Ge.getFunscriptFromString=void 0;var Vi=Bo(),ku=function(n){var e=JSON.parse(n);return Ge.addFunscriptMetadata(e)};Ge.getFunscriptFromString=ku;var Uu=function(n){var e=Qt({},n);e.actions=e.actions.sort(function(i,o){return i.at-o.at}).map(Vi.roundAction);var t=e.actions.slice(-1)[0].at,r=e.actions.reduce(function(i,o,c){if(c===0)return i;var h=Vi.getSpeed(e.actions[c-1],e.actions[c]);return i+h},0)/(e.actions.length-1);return e.metadata=Qt(Qt({},e.metadata),{duration:t,average_speed:r}),e};Ge.addFunscriptMetadata=Uu;var $u=function(n){var e=JSON.parse(n),t=e.actions.map(function(i){var o=Vi.roundAction(i);return o.at+","+o.pos}).join(`
`),r=new Blob([t],{type:"text/plain"});return r};Ge.convertFunscriptToCsv=$u});var pt=fs(Mo(),1);import{ButtplugWasmClientConnector as wo}from"https://cdn.jsdelivr.net/npm/buttplug-wasm@2.0.1/dist/buttplug-wasm.mjs";var yn=class{_client=new pt.ButtplugClient;_deviceRefleshedEvents=[];levelViberation=0;UFOTWReverseLR=!1;get isViberatorConnected(){return this.Devices.Viberators.length>0}get isRotatorConnected(){return this.Devices.Rotators.length>0}get isLinearsConnected(){return this.Devices.Linears.length>0}get isUFOTWConnected(){return this.Devices.UFOTW.length>0}Devices={Viberators:[],Rotators:[],Linears:[],UFOTW:[]};constructor(){console.log("buttplugOperator constructed."),this._client.addListener("deviceadded",async e=>{console.log(`device added: ${e.name}`),this.ParseDeviceList()}),this._client.addListener("deviceremoved",e=>{console.log(`device removed: ${e.name}`),this.ParseDeviceList()})}async connectWasm(){return wo.activateLogging(),this.connect(new wo)}async connectWebsocket(e){let t=new pt.ButtplugBrowserWebsocketClientConnector(e);return this.connect(t)}async connect(e){try{await this._client.connect(e)}catch(t){return console.log(`${t}`),t instanceof pt.ButtplugError&&(console.log("this is a buttplug error"),t instanceof pt.ButtplugClientConnectorException?console.log("This is a connector error"):console.log("Was another type of error")),!1}return!0}AddDevicesRefleshedEvents(e){this._deviceRefleshedEvents.push(e)}ParseDeviceList(){this.Devices.Viberators.splice(0),this.Devices.Rotators.splice(0),this.Devices.Linears.splice(0),this.Devices.UFOTW.splice(0);for(let e of this._client.devices){e.name==="Vorze UFO TW"?(this.Devices.UFOTW.push(e),e.rotate([[.3,!0],[.3,!1]]),setTimeout(()=>{e.stop()},600)):e.vibrateAttributes.length>0?(this.Devices.Viberators.push(e),e.vibrate(.5),setTimeout(()=>{e.stop()},600)):e.rotateAttributes.length>0?(this.Devices.Rotators.push(e),e.rotate(.5,!0),setTimeout(()=>{e.stop()},600)):e.linearAttributes.length>0&&(this.Devices.Linears.push(e),e.linear(0,1e3),setTimeout(()=>{e.linear(.5,1e3)},1e3),setTimeout(()=>{e.linear(0,1e3)},2e3)),console.log("Viberators:");for(let t of this.Devices.Viberators)console.log("  "+t.name);console.log("Rotators:");for(let t of this.Devices.Rotators)console.log("  "+t.name);console.log("Linears:");for(let t of this.Devices.Linears)console.log("  "+t.name)}for(let e of this._deviceRefleshedEvents)e()}StopAllDevices(){for(let e of this.Devices.Viberators)e.stop();for(let e of this.Devices.Rotators)e.stop();for(let e of this.Devices.Linears)e.stop();for(let e of this.Devices.UFOTW)e.stop()}ForceStopAllDevices(){this.levelViberation=0,this.SendViberateCmd(.1),this.SendRotateCmd(.2,!0),this.SendLinearCmd(.2,1e3),this.SendUFOTWCmd(.2,!0,.2,!0),setTimeout(()=>{this.StopAllDevices()},500)}UpViberationDevice(){console.log("UpViberationDevice: "+this.levelViberation),this.levelViberation<=.8?this.levelViberation=this.levelViberation+.1:this.levelViberation=.9,this.SendViberateCmd(this.levelViberation)}DownViberationDevice(){console.log("DownViberationDevice: "+this.levelViberation),this.levelViberation>=.2?this.levelViberation=this.levelViberation-.1:this.levelViberation=.1,this.SendViberateCmd(this.levelViberation)}SendViberateCmd(e){console.log("SendViberateCmd: "+e),this.Devices.Viberators.forEach(t=>{t.vibrate(e)})}SendRotateCmd(e,t){this.Devices.Rotators.forEach(r=>{r.rotate(e,t)})}SendLinearCmd(e,t){this.Devices.Linears.forEach(r=>{r.linear(e,t)})}SendUFOTWCmd(e,t,r,i){this.Devices.UFOTW.forEach(o=>{this.UFOTWReverseLR?o.rotate([[r,i],[e,t]]):o.rotate([[e,t],[r,i]])})}async ConnectDevice(){this._client.connected?await this._client.startScanning():console.log("buttplug client is not connected.")}};var me=class{Milliseconds=0;Power=0;constructor(e,t){this.Milliseconds=e,t<0?this.Power=0:t>1e3?this.Power=1e3:this.Power=t}get ButtPower(){return this.Power/1e3}get Seconds(){return Math.trunc(this.Milliseconds/1e3)}get HHMMSS(){let e=Math.floor(this.Milliseconds/1e3),t=Math.floor(e/60),r=Math.floor(t/60),i=String(e%60).padStart(2,"0"),o=String(t%60).padStart(2,"0");return`${String(r).padStart(2,"0")}:${o}:${i}`}toString(){return`Time: ${this.Milliseconds}, Power: ${this.ButtPower}`}},To=/^([0-9]+)(\.[0-9]{1,2})?,(1000|[0-9]+)$/;function Eo(n){let t=n.replace(/\r\n|\r/g,`
`).split(/\n/);t.slice(-1)[0]===""&&t.pop();let r=!0;for(let i=0;i<t.length;i++)if(!t[i].match(To)){r=!1;break}return r}function Oo(n){let t=n.replace(/\r\n|\r/g,`
`).split(/\n/),r=[];for(let i of t){let o=i.match(To);if(o){let c=Number(o[1])*1e3;if(o[2]){let S=o[2].replace(".",""),D;S.length==1?D=Number(S)*10:D=Number(S),c+=D*10}let h=Number(o[3]),p=new me(c,h);r.push(p)}}return console.log("script start time: "+r[0].HHMMSS),r}function ki(n){let e=[];for(let r of n){let i=r.Seconds;e[i]||(e[i]=[]),e[i].push(r)}return e}var Pu=[new me(500,800),new me(600,0),new me(1500,400),new me(1600,0),new me(2500,800),new me(2600,0),new me(3500,400),new me(3600,0),new me(4500,800),new me(4600,0),new me(5500,400),new me(5600,0),new me(6500,800),new me(6600,0),new me(7500,400),new me(7600,0)],ql=ki(Pu);var Ui=class{Milliseconds=0;Clockwise=!0;Power=0;get ButtPower(){return this.Power/100}get Seconds(){return Math.trunc(this.Milliseconds/1e3)}get HHMMSS(){let e=Math.floor(this.Milliseconds/1e3),t=Math.floor(e/60),r=Math.floor(t/60),i=String(e%60).padStart(2,"0"),o=String(t%60).padStart(2,"0");return`${String(r).padStart(2,"0")}:${o}:${i}`}constructor(e,t,r){this.Milliseconds=e,this.Clockwise=t,r<0?this.Power=0:r>100?this.Power=100:this.Power=r}toString(){return`Time: ${this.Milliseconds}, Clockwise: ${this.Clockwise} Power: ${this.ButtPower}`}},Lo=/^([0-9]+),(0|1),(100|[0-9]{1,2})$/;function Co(n){let t=n.replace(/\r\n|\r/g,`
`).split(/\n/);t.slice(-1)[0]===""&&t.pop();let r=!0;for(let i=0;i<t.length;i++)if(!t[i].match(Lo)){r=!1;break}return r}function Do(n){let t=n.replace(/\r\n|\r/g,`
`).split(/\n/),r=[];for(let i of t){let o=i.match(Lo);if(o){let c=Number(o[1])*100,h=o[2]==="1",p=Number(o[3]),S=new Ui(c,h,p);r.push(S)}}return console.log("script start time: "+r[0].HHMMSS),r}function Ao(n){let e=[];for(let r of n){let i=r.Seconds;e[i]||(e[i]=[]),e[i].push(r)}return e}var $i=class{Milliseconds=0;LeftClockwise=!0;LeftPower=0;RightClockwise=!0;RightPower=0;get LeftButtPower(){return this.LeftPower/100}get RightButtPower(){return this.RightPower/100}get Seconds(){return Math.trunc(this.Milliseconds/1e3)}get HHMMSS(){let e=Math.floor(this.Milliseconds/1e3),t=Math.floor(e/60),r=Math.floor(t/60),i=String(e%60).padStart(2,"0"),o=String(t%60).padStart(2,"0");return`${String(r).padStart(2,"0")}:${o}:${i}`}constructor(e,t,r,i,o){this.Milliseconds=e,this.LeftClockwise=t,this.RightClockwise=i,r<0?this.LeftPower=0:r>100?this.LeftPower=100:this.LeftPower=r,o<0?this.RightPower=0:o>100?this.RightPower=100:this.RightPower=o}toString(){return`Time: ${this.Milliseconds}, LeftClockwise: ${this.LeftClockwise} LeftPower: ${this.LeftButtPower}, LeftClockwise: ${this.RightClockwise} LeftPower: ${this.RightButtPower}`}},xo=/^([0-9]+),(0|1),(100|[0-9]{1,2}),(0|1),(100|[0-9]{1,2})$/;function Po(n){let t=n.replace(/\r\n|\r/g,`
`).split(/\n/);t.slice(-1)[0]===""&&t.pop();let r=!0;for(let i=0;i<t.length;i++)if(!t[i].match(xo)){r=!1;break}return r}function Ro(n){let t=n.replace(/\r\n|\r/g,`
`).split(/\n/),r=[];for(let i of t){let o=i.match(xo);if(o){let c=Number(o[1])*100,h=o[2]==="1",p=Number(o[3]),S=o[4]==="1",D=Number(o[5]),C=new $i(c,h,p,S,D);r.push(C)}}return console.log("script start time: "+r[0].HHMMSS),r}function Io(n){let e=[];for(let r of n){let i=r.Seconds;e[i]||(e[i]=[]),e[i].push(r)}return e}var Wi=fs(Fo(),1),Sn=class{Title;Origin;Ranged;Splitted;get OriginMin(){return this.getMin(this.Origin)}get OriginMax(){return this.getMax(this.Origin)}get RangedMin(){return this.getMin(this.Ranged)}get RangedMax(){return this.getMax(this.Ranged)}constructor(e,t){this.Title=e;let r=(0,Wi.getFunscriptFromString)(t),i=this.ConvertJsonToScript(r);console.log("funscript loaded. lines: "+i.length),console.log("script start time: "+i[0].HHMMSS),this.Origin=i,this.Ranged=i,this.Splitted=this.SplitLines(i)}ConvertJsonToScript(e){let t=e.actions,r=[],i=0;for(let o of t){let c=o.at-i;r.push(new _n(i,o.pos,c)),i=o.at}return r}SetRange(e,t){let r=[];for(let i of this.Origin){let o=this.normalize(i.Position,this.OriginMin,this.OriginMax,e,t),c=new _n(i.Milliseconds,o,i.Duration);r.push(c)}this.Ranged=r,this.Splitted=this.SplitLines(r);for(let i=0;i<10;i++)console.log(this.Ranged[i]);console.log("newmin: "+this.getMin(this.Ranged)),console.log("newmax: "+this.getMax(this.Ranged)),console.log("splitted.length: "+this.Splitted.length)}Validate(e){try{let t=(0,Wi.getFunscriptFromString)(e);return!0}catch{return console.log("Loading funscript is failed."),!1}}getMin(e){let t=e.map(i=>i.Position),r=(i,o)=>Math.min(i,o);return t.reduce(r)}getMax(e){let t=e.map(i=>i.Position),r=(i,o)=>Math.max(i,o);return t.reduce(r)}SplitLines(e){let t=[];for(let i of e){let o=i.Seconds;t[o]||(t[o]=[]),t[o].push(i)}return t}normalize(e,t,r,i,o){if(t>r)throw new RangeError("oldMin is greater than oldMax.");if(i>o)throw new RangeError("newMin is greater than newMax.");e>r&&(e=r),e<t&&(e=t);let c=r-t,h=o-i;return(e-t)*h/c+i}},_n=class{Milliseconds=0;Position=0;Duration=0;get Seconds(){return Math.trunc(this.Milliseconds/1e3)}get ButtPosition(){return this.Position/100}get HHMMSS(){let e=this.Seconds,t=Math.floor(e/60),r=Math.floor(t/60),i=String(e%60).padStart(2,"0"),o=String(t%60).padStart(2,"0");return`${String(r).padStart(2,"0")}:${o}:${i}`}constructor(e,t,r){if(e<0)throw new RangeError("milliseconds does not accept negative values.");if(t<0||t>100)throw new RangeError("position does not accept values outside the range 0 to 100.");if(r<0)throw new RangeError("milliseconds does not accept negative values.");this.Milliseconds=e,this.Duration=r,this.Position=t}toString(){return`Time: ${this.Milliseconds}, Positon: ${this.Position}, Duration: ${this.Duration}`}};var Mn=class{_buttplugOperator;_previousSeconds=0;_timerIDs=new Set;VorzeSAScriptToUFOTW=!1;Offset=0;Scripts={TimeRoter:void 0,Vorze_SA:void 0,Funscript:void 0,UFOTW:void 0};constructor(e){this._buttplugOperator=e}LoadScript(e,t){if(console.log("path: "+t),t.endsWith(".funscript"))return this.Scripts.Funscript=new Sn(t,e),!0;if(Eo(e)){let r=Oo(e);return this.Scripts.TimeRoter={Script:r,Splitted:ki(r),Title:t},console.log("timeroter script loaded. lines: "+r.length),!0}else if(Po(e)){let r=Ro(e);return this.Scripts.UFOTW={Script:r,Splitted:Io(r),Title:t},console.log("UFOTW script loaded. lines: "+r.length),!0}else if(Co(e)){let r=Do(e);return this.Scripts.Vorze_SA={Script:r,Splitted:Ao(r),Title:t},console.log("Vorze_SA script loaded. lines: "+r.length),!0}else return!1}Stop(){this._previousSeconds=0,this._buttplugOperator.StopAllDevices(),this._timerIDs.forEach(e=>{clearTimeout(e)}),this._timerIDs.clear()}TimeUpdate(e){let t=e+this.Offset,r=Math.trunc(t);r!==this._previousSeconds&&(this.OperateTimeRoterScript(t),this.OperateVorzeSAScript(t),this.OperateFunscript(t),this.OperateUFOTWScript(t),this._previousSeconds=r)}SetFunscriptRange(e,t){this.Scripts.Funscript?.SetRange(e,t)}OperateTimeRoterScript(e){if(!this.Scripts.TimeRoter)return;let t=Math.trunc(e),r=this.Scripts.TimeRoter.Splitted;this._buttplugOperator.isViberatorConnected&&t!==this._previousSeconds&&r[t+1]&&r[t+1].forEach(i=>{let o=i.Milliseconds-Math.trunc(e*1e3),c=`send ViberateMsg: ${i.toString()}`;setTimeout(()=>console.log(c),o);let h=window.setTimeout(()=>{this._buttplugOperator.SendViberateCmd(i.ButtPower)},o);this._timerIDs.add(h),setTimeout(()=>{this._timerIDs.delete(h)},3e3)})}OperateVorzeSAScript(e){if(!this.Scripts.Vorze_SA)return;let t=Math.trunc(e),r=this.Scripts.Vorze_SA.Splitted;(this._buttplugOperator.isRotatorConnected||this.VorzeSAScriptToUFOTW&&this._buttplugOperator.isUFOTWConnected)&&t!==this._previousSeconds&&r[t+1]&&r[t+1].forEach(o=>{let c=o.Milliseconds-Math.trunc(e*1e3),h=`send RotateMsg: ${o.toString()}`;setTimeout(()=>console.log(h),c);let p=window.setTimeout(()=>{this._buttplugOperator.SendRotateCmd(o.ButtPower,o.Clockwise),this.VorzeSAScriptToUFOTW&&this._buttplugOperator.SendUFOTWCmd(o.ButtPower,o.Clockwise,o.ButtPower,o.Clockwise)},c);this._timerIDs.add(p),setTimeout(()=>{this._timerIDs.delete(p)},3e3)})}OperateUFOTWScript(e){if(!this.Scripts.UFOTW)return;let t=Math.trunc(e),r=this.Scripts.UFOTW.Splitted;this._buttplugOperator.isUFOTWConnected&&!this.VorzeSAScriptToUFOTW&&t!==this._previousSeconds&&r[t+1]&&r[t+1].forEach(i=>{let o=i.Milliseconds-Math.trunc(e*1e3),c=`send RotateMsg: ${i.toString()}`;setTimeout(()=>console.log(c),o);let h=window.setTimeout(()=>{this._buttplugOperator.SendUFOTWCmd(i.LeftButtPower,i.LeftClockwise,i.RightButtPower,i.RightClockwise)},o);this._timerIDs.add(h),setTimeout(()=>{this._timerIDs.delete(h)},3e3)})}OperateFunscript(e){if(!this.Scripts.Funscript)return;let t=Math.trunc(e),r=e*1e3,i=this.Scripts.Funscript.Splitted;this._buttplugOperator.isLinearsConnected&&t!==this._previousSeconds&&i[t+1]&&i[t+1].forEach(o=>{let c=o.Milliseconds-r,h=`send LinearMsg: ${o.toString()}`;setTimeout(()=>console.log(h),c);let p=window.setTimeout(()=>{this._buttplugOperator.SendLinearCmd(o.ButtPosition,o.Duration)},c);this._timerIDs.add(p),setTimeout(()=>{this._timerIDs.delete(p)},3e3)})}};var wn=class{Player=document.getElementById("player");MediaNameSpan=document.getElementById("mediaNameSpan");OffsetInput=document.getElementById("offset");OffsetPlusButton=document.getElementById("offsetPlusButton");OffsetMinusButton=document.getElementById("offsetMinusButton");UFOTWsettingli=document.getElementsByClassName("UFOTWsettingli");UFOTWreverseLRCheckbox=document.getElementById("UFOTWreverseLRCheckbox");VorzeSAScriptToUFOTWCheckbox=document.getElementById("VorzeSAScriptToUFOTWCheckbox");VibDeviceList=document.getElementById("VibDeviceList");RotatorDeviceList=document.getElementById("RotatorDeviceList");LinearDeviceList=document.getElementById("LinearDeviceList");UFOTWDeviceList=document.getElementById("UFOTWDeviceList");TimeRoterScriptList=document.getElementById("TimeRoterScriptList");VorzeSAScriptList=document.getElementById("VorzeSAScriptList");FunscriptList=document.getElementById("FunscriptList");UFOTWScriptList=document.getElementById("UFOTWScriptList");ScriptInput=document.getElementById("scriptInput");MediaInput=document.getElementById("mediaInput");ConnectServerButton=document.getElementById("connectServerButton");ConnectDeviceButton=document.getElementById("connectDeviceButton");ConnectStatusSpan=document.getElementById("connectStatus");ForceStopButton=document.getElementById("forceStopButton");UpViberationButton=document.getElementById("upViberationButton");DownViberationButton=document.getElementById("downViberationButton");FunscriptSlider;AppendToList(e,t){let r=document.createElement("li"),i=document.createElement("span");return i.className="name",i.innerText=t,r.appendChild(i),e.appendChild(r),r}AppendVibDeviceList(e){this.AppendToList(this.VibDeviceList,e)}AppendRotatorDeviceList(e){this.AppendToList(this.RotatorDeviceList,e)}AppendLinearDeviceList(e){this.AppendToList(this.LinearDeviceList,e)}AppendUFOTWDeviceList(e){this.AppendToList(this.UFOTWDeviceList,e)}AppendTimeRoterScriptList(e){this.AppendToList(this.TimeRoterScriptList,e)}AppendVorzeSAScriptList(e){this.AppendToList(this.VorzeSAScriptList,e)}AppendUFOTWScriptList(e){this.AppendToList(this.UFOTWScriptList,e)}AppendFunscriptList(e){let t=this.AppendToList(this.FunscriptList,e),r=document.createElement("slider-container");t.appendChild(r),r.InitializeSlider(),this.FunscriptSlider=r}ClearDeviceLists(){this.VibDeviceList.innerHTML="",this.RotatorDeviceList.innerHTML="",this.LinearDeviceList.innerHTML=""}ClearScriptLists(){this.TimeRoterScriptList.innerHTML="",this.VorzeSAScriptList.innerHTML="",this.FunscriptList.innerHTML="",this.UFOTWScriptList.innerHTML=""}AddFunscriptSliderUpdateEvent(e){let t=this.FunscriptSlider;t?.addEventListener("mouseup",()=>{e(t.range_min,t.range_max)})}};var Tn=class{ButtplugOperator;constructor(e){this.ButtplugOperator=e}actionByResult(e){if(console.log("actionByResult() called."),this.isMatchWord(e,"\u3082\u3063\u3068")||this.isMatchWord(e,"\u5F37\u304F")||this.isMatchWord(e,"\u304A\u9858\u3044"))return this.UpVibration();if(this.isMatchWord(e,"\u5F31\u304F"))return this.DownVibration();if(this.isMatchWord(e,"\u6B62\u3081\u3066")||this.isMatchWord(e,"\u30B9\u30C8\u30C3\u30D7"))return this.StopVibration();if(this.isMatchWord(e,"\u3044\u304D\u305D\u3046")||this.isMatchWord(e,"\u884C\u304D\u305D\u3046")||this.isMatchWord(e,"\u3044\u304F")||this.isMatchWord(e,"\u884C\u304F"))return this.SetVibration(.9)}isMatchWord(e,t){return e.indexOf(t)!=-1}UpVibration(){this.ButtplugOperator.UpViberationDevice()}DownVibration(){this.ButtplugOperator.DownViberationDevice()}SetVibration(e){this.ButtplugOperator.SendViberateCmd(e)}StopVibration(){this.ButtplugOperator.ForceStopAllDevices()}};var Vu=window.SpeechRecognition||window.webkitSpeechRecognition,Le=new Vu,En=class{ButtplugOperator;ScriptOperator;UI;action;constructor(){this.ButtplugOperator=new yn,this.ScriptOperator=new Mn(this.ButtplugOperator),this.UI=new wn,this.action=new Tn(this.ButtplugOperator),this.addEvents()}async ConnectWasm(){let e=this.UI.ConnectStatusSpan;e.innerText="\u6E96\u5099\u4E2D..",await this.ButtplugOperator.connectWasm()?e.innerText="\u6E96\u5099\u5B8C\u4E86":e.innerText="\u6E96\u5099\u306B\u5931\u6557\u3057\u307E\u3057\u305F"}async ConnectServer(){console.log("ConnectServer() called.");let e=document.getElementById("serverURL"),t=this.UI.ConnectStatusSpan;t.innerText="\u63A5\u7D9A\u4E2D...",await this.ButtplugOperator.connectWebsocket("ws://"+e.value)?t.innerText="\u63A5\u7D9A\u6210\u529F: "+e.value:t.innerText="\u63A5\u7D9A\u5931\u6557"}RefleshDeviceLists(){let e=this.UI;e.ClearDeviceLists();for(let t of this.ButtplugOperator.Devices.Viberators)e.AppendVibDeviceList(t.name);for(let t of this.ButtplugOperator.Devices.Rotators)e.AppendRotatorDeviceList(t.name);for(let t of this.ButtplugOperator.Devices.Linears)e.AppendLinearDeviceList(t.name);if(this.ButtplugOperator.Devices.UFOTW.length>0){for(let t of this.ButtplugOperator.Devices.UFOTW)e.AppendUFOTWDeviceList(t.name);for(let t of e.UFOTWsettingli)t.style.display="list-item"}else for(let t of e.UFOTWsettingli)t.style.display="none"}RefleshScriptLists(){let e=this.UI;e.ClearScriptLists();let t=this.ScriptOperator.Scripts.TimeRoter,r=this.ScriptOperator.Scripts.Vorze_SA,i=this.ScriptOperator.Scripts.Funscript,o=this.ScriptOperator.Scripts.UFOTW;t&&e.AppendTimeRoterScriptList(t.Title),r&&e.AppendVorzeSAScriptList(r.Title),o&&e.AppendUFOTWScriptList(o.Title),i&&(e.AppendFunscriptList(i.Title),e.FunscriptSlider.range_min=i.RangedMin,e.FunscriptSlider.range_max=i.RangedMax,e.FunscriptSlider.addEventListener("mouseup",()=>{let c=e.FunscriptSlider.range_min,h=e.FunscriptSlider.range_max;i.SetRange(c,h)}))}OffsetValueChanged(e){this.ScriptOperator.Offset=e}OffsetPlusMinusButtonEvent(e){let t=this.UI.OffsetInput,r=Number(t.value);e?r+=.1:r-=.1,r=Math.round(r*100)/100,t.value=String(r),this.OffsetValueChanged(r)}LoadScript(){let e=this.UI.ScriptInput.files[0];if(e!=null){let t=new FileReader;t.readAsText(e),t.onload=()=>{t.result&&this.ScriptOperator.LoadScript(t.result,e.name)&&this.RefleshScriptLists()},t.onerror=()=>{console.log(t.error)}}}LoadMedia(){let e=this.UI,t=e.MediaInput.files;t&&(t[0].type.startsWith("video/")?(e.Player.src=URL.createObjectURL(t[0]),e.Player.style.height="auto",e.MediaNameSpan.innerText=t[0].name):t[0].type.startsWith("audio/")?(e.Player.src=URL.createObjectURL(t[0]),e.Player.style.height="3em",e.MediaNameSpan.innerText=t[0].name):e.MediaNameSpan.innerText="\u3053\u306E\u30D5\u30A1\u30A4\u30EB\u306F\u518D\u751F\u3067\u304D\u307E\u305B\u3093: "+t[0].name,e.MediaInput.files=null)}addEvents(){console.log("addEvent() called.");let e=this.UI;e.ConnectDeviceButton.addEventListener("click",async()=>{await this.ButtplugOperator.ConnectDevice();let t=this.action;Le.lang="ja-JP",Le.interimResults=!0,Le.continuous=!0,Le.onsoundstart=function(){console.log("\u97F3\u58F0\u8A8D\u8B58\u8A8D\u8B58\u4E2D")},Le.onnomatch=function(){Le.start()},Le.onresult=function(r){let i=r.results,o=i[i.length-1][0].transcript.trim();console.log(o),t.actionByResult(o)},Le.onerror=function(){console.log("\u97F3\u58F0\u8A8D\u8B58\u30A8\u30E9\u30FC"),console.error(),Le.stop()},Le.onsoundend=function(){console.log("\u97F3\u58F0\u8A8D\u8B58\u505C\u6B62\u4E2D")},Le.onend=function(){console.log("\u97F3\u58F0\u8A8D\u8B58\u7D42\u4E86"),Le.stop(),Le.start()},console.log("\u97F3\u58F0\u8A8D\u8B58\u958B\u59CB"),Le.start()}),e.ConnectServerButton!=null?e.ConnectServerButton?.addEventListener("click",async()=>this.ConnectServer()):this.ConnectWasm(),this.ButtplugOperator.AddDevicesRefleshedEvents(()=>this.RefleshDeviceLists()),e.ForceStopButton.addEventListener("click",()=>{this.ButtplugOperator.ForceStopAllDevices(),Le.stop()}),e.UpViberationButton.addEventListener("click",()=>{this.ButtplugOperator.UpViberationDevice()}),e.DownViberationButton.addEventListener("click",()=>{this.ButtplugOperator.DownViberationDevice()})}};(()=>{var n=Object.defineProperty,e=Math.pow,t=(s,u,m)=>u in s?n(s,u,{enumerable:!0,configurable:!0,writable:!0,value:m}):s[u]=m,r=(s,u,m)=>(t(s,typeof u!="symbol"?u+"":u,m),m),i=(s,u)=>` ${u&&u.length>0?u.map(m=>`<link rel="stylesheet" href="${m}" />`).join(""):""} <style> ${s} </style> <div class="range-slider-box"> <div class="row"> <div id="range-slider" class="range-slider"> <div class="container"> <div class="panel"></div> <div class="panel-fill"></div> <div class="container"> <div class="pointer" tabindex="0" role="slider"> <div class="pointer-shape"></div> </div> </div> </div> </div> </div> </div>`,o=":host{--width:300px;--height:.25rem;--opacity:.4;--panel-bg:#cbd5e1;--panel-bg-hover:#94a3b8;--panel-bg-fill:#475569;--panel-bg-border-radius:1rem;--pointer-width:1rem;--pointer-height:1rem;--pointer-bg:#fff;--pointer-bg-hover:#dcdcdc;--pointer-bg-focus:#dcdcdc;--pointer-shadow:0 0 2px rgba(0,0,0,0.8);--pointer-shadow-hover:0 0 2px #000;--pointer-shadow-focus:var(--pointer-shadow-hover);--pointer-border:1px solid hsla(0,0%,88%,0.5);--pointer-border-hover:1px solid #94a3b8;--pointer-border-focus:var(--pointer-border-hover);--pointer-border-radius:100%;--animate-onclick:.3s}:host{max-width:100%}.range-slider-box{display:flex;position:relative;flex-direction:column}.range-slider{position:relative;width:var(--width,100%);height:var(--height,0.25rem);touch-action:none;max-width:100%;box-sizing:border-box;cursor:pointer}.row{width:100%;display:flex;align-items:center}.range-slider.disabled{opacity:var(--opacity,0.4);cursor:default}.pointer.disabled{-webkit-filter:brightness(0.8);filter:brightness(0.8);cursor:default}.range-slider *{box-sizing:border-box}.container{position:absolute;width:100%;height:100%}.panel{position:absolute;z-index:10;width:100%;height:100%;background:var(--panel-bg,#2d4373);border-radius:var(--panel-bg-border-radius,1rem);overflow:hidden;transition:.3s all ease}.panel-fill{background:var(--panel-bg-fill,#000);border-radius:var(--panel-bg-border-radius,1rem);overflow:hidden;height:100%;position:absolute;z-index:10}.panel:hover{background:var(--panel-bg-hover,#5f79b7)}.disabled .panel:hover{background:var(--panel-bg,#5f79b7)}.pointer{position:absolute;z-index:20;outline:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.pointer-shape{background:var(--pointer-bg,#fff);background-size:contain;box-shadow:var(--pointer-shadow);border:var(--pointer-border);border-radius:var(--pointer-border-radius,100%);-webkit-transform:translateX(-50%);transform:translateX(-50%);width:var(--pointer-width,15px);height:var(--pointer-height,15px);transition:.3s all ease}.pointer-shape:hover{background:var(--pointer-bg-hover,#fff);background-size:contain;border:var(--pointer-border-hover);box-shadow:var(--pointer-shadow-hover)}.disabled .pointer-shape:hover{background:var(--pointer-bg,#fff);background-size:contain;border:var(--pointer-border);box-shadow:var(--pointer-shadow)}.pointer:focus .pointer-shape{background:var(--pointer-bg-focus,#fff);background-size:contain;border:var(--pointer-border-focus);box-shadow:var(--pointer-shadow-focus)}.disabled .pointer:focus .pointer-shape{background:var(--pointer-bg,#fff);background-size:contain;border:var(--pointer-border);box-shadow:var(--pointer-shadow)}.type-vertical .range-slider{--width:.25rem;--height:300px;max-height:100%}.type-vertical .range-slider .pointer{left:50%}.type-vertical .range-slider .panel-fill{width:100%}.type-vertical.range-slider-box{flex-direction:row}.type-vertical .row{flex-direction:column}.animate-on-click .pointer,.animate-on-click .panel-fill{transition:all var(--animate-onclick)}.range-dragging .panel-fill{cursor:move}",c="pointers-overlap",h="pointers-min-distance",p="pointers-max-distance",S="range-dragging",D="data",C="min",oe="max",k="step",se="round",_e="type",ze="theme",tt="rtl",F="btt",Y="disabled",ht="keyboard-disabled",rt="mousewheel-disabled",Ln="slider-width",Cn="slider-height",Dn="slider-radius",An="slider-bg",xn="slider-bg-hover",Pn="slider-bg-fill",Rn="pointer-width",In="pointer-height",er="pointer-radius",Bt="pointer-bg",tr="pointer-bg-hover",rr="pointer-bg-focus",nr="pointer-shadow",ir="pointer-shadow-hover",sr="pointer-shadow-focus",or="pointer-border",I="pointer-border-hover",nt="pointer-border-focus",ar="animate-onclick",te="css-links",Ie="vertical",it="horizontal",_t=(s,u,m,f,M)=>{let B=u-s;return B===0?m:(f-m)*(M-s)/B+m},Ve=s=>!isNaN(parseFloat(s))&&isFinite(s),z=(s,u)=>Ve(s)?Number(s):u,Ft=(s,u)=>u===0?0:Math.round(s/u)*u,st=(s,u=1/0)=>{if(u===1/0)return s;let m=e(10,u);return Math.round(s*m)/m},fe=s=>s==null?!1:typeof s=="boolean"?s:s.trim().toLowerCase()==="true",Bn=(s,u)=>{s.dispatchEvent(new CustomEvent("onPointerClicked",{detail:{$pointer:u}}))},jt=(s,u)=>{s.dispatchEvent(new CustomEvent("onMouseDown",{detail:{nativeEvent:u}}))},ur=(s,u)=>{s.dispatchEvent(new CustomEvent("onMouseUp",{detail:{nativeEvent:u}}))},lr=(s,u)=>{s.dispatchEvent(new CustomEvent("onKeyDown",{detail:{nativeEvent:u}}))},cr=(s,u)=>{if(!u||u.length<=0)return;let m=u.map(M=>Ve(M)?z(M,M):M),f={values:m||[]};f.value=m[0],f.value0=m[0],f.value1=m[0];for(let M=1;M<m.length;M++)f[`value${M+1}`]=m[M];s.dispatchEvent(new CustomEvent("change",{detail:f}))},Mt=(s,u,m)=>{let f=0,M,B,$,T,E=!1,W=(N,ee,ye,ge,ue,le)=>{let Ce=f;ye!==void 0&&N>ye&&(N=ye),ee!==void 0&&N<ee&&(N=ee),f=N;let De=f;return(ge===Ie&&le||ge===it&&ue)&&(De=100-De),ge===Ie?u.style.top=`${De}%`:u.style.left=`${De}%`,Ce!==f},q=N=>N===u||u.contains(N),R=(N,ee,ye,ge)=>{M=N,B=ee,$=ye,T=ge},K=N=>{E=N,u.classList.toggle("disabled",E),E?u.setAttribute("aria-disabled","true"):u.hasAttribute("aria-disabled")&&u.removeAttribute("aria-disabled")},je=(N,ee)=>{ee==null?u.removeAttribute(N):u.setAttribute(N,ee)},Me=N=>u.getAttribute(N),j=N=>{if(!E){switch(N.key){case"ArrowLeft":{N.preventDefault(),typeof M=="function"&&M(m);break}case"ArrowRight":{N.preventDefault(),typeof B=="function"&&B(m);break}case"ArrowUp":{N.preventDefault(),typeof $=="function"&&$(m);break}case"ArrowDown":{N.preventDefault(),typeof T=="function"&&T(m);break}}lr(s,N)}},H=()=>{E||Bn(s,u)};return u.className=`pointer pointer-${m}`,u.addEventListener("keydown",j),u.addEventListener("click",H),{$pointer:u,get percent(){return f},get disabled(){return E},set disabled(N){K(N)},updatePosition:W,isClicked:q,setCallbacks:R,setAttr:je,getAttr:Me,destroy:()=>{u.removeEventListener("keydown",j),u.removeEventListener("click",H),u.remove()}}},dr=s=>{if(s==null)return;if(Array.isArray(s))return s;if(s.trim()==="")return;let u=s.split(","),m=[],f=!0;for(let M=0;M<u.length;M++){let B=u[M].trim();B!==""&&(m.push(B),Ve(B)||(f=!1))}return f?m.map(M=>Number(M)):m},Nt=(s,u)=>u?u.findIndex(m=>m===s||m.toString().trim()===s.toString().trim()):-1,Fn=s=>({updatePosition:(u,m,f,M)=>{if(m.length<=0)return;let B=m.length===1,$=m[0],T=m[m.length-1];u===Ie?(s.style.removeProperty("width"),s.style.removeProperty("right"),s.style.removeProperty("left"),B?s.style.height=`${$}%`:s.style.height=`${Math.abs($-T)}%`,M?(s.style.bottom="0%",B?s.style.top="auto":s.style.top=`${Math.min(100-T,100-$)}%`):(s.style.bottom="auto",B?s.style.top="0%":s.style.top=`${Math.min($,T)}%`)):(s.style.removeProperty("height"),s.style.removeProperty("top"),s.style.removeProperty("bottom"),B?s.style.width=`${$}%`:s.style.width=`${Math.abs($-T)}%`,f?(s.style.right="0%",B?s.style.left="auto":s.style.left=`${Math.min(100-T,100-$)}%`):(s.style.right="auto",B?s.style.left="0%":s.style.left=`${Math.min($,T)}%`))}}),fr="--animate-onclick",jn="--width",Nn="--height",gt="--panel-bg-border-radius",kn="--panel-bg",Un="--panel-bg-hover",$n="--panel-bg-fill",kt="--pointer-width",l="--pointer-height",d="--pointer-border-radius",g="--pointer-bg",y="--pointer-bg-hover",x="--pointer-bg-focus",re="--pointer-shadow",ae="--pointer-shadow-hover",U="--pointer-shadow-focus",_="--pointer-border",w="--pointer-border-hover",O="--pointer-border-focus",L=(s,u,m)=>{let f=new Map;for(let M of s.attributes){let B=M.nodeName.trim().toLowerCase();if(!u.test(B))continue;let $=B.replace(/\D/g,"").trim(),T=$===""||$==="0"||$==="1"?0:z($,0)-1,E=m&&typeof m=="function"?m(M.value):M.value;f.set(T,E)}return f},V=s=>{if(!s)return null;let u=s.getAttribute(te);if(!u)return null;let m=u.split(";"),f=[];for(let M of m)M.trim()!==""&&f.push(M.trim());return f},Q=[[jn,Ln,"sliderWidth",null],[Nn,Cn,"sliderHeight",null],[gt,Dn,"sliderRadius",null],[kn,An,"sliderBg",null],[Un,xn,"sliderBgHover",null],[$n,Pn,"sliderBgFill",null],[kt,Rn,"pointer#Width",/^pointer([0-9]*)-width$/],[l,In,"pointer#Height",/^pointer([0-9]*)-height$/],[d,er,"pointer#Radius",/^pointer([0-9]*)-radius$/],[g,Bt,"pointer#Bg",/^pointer([0-9]*)-bg$/],[y,tr,"pointer#BgHover",/^pointer([0-9]*)-bg-hover$/],[x,rr,"pointer#BgFocus",/^pointer([0-9]*)-bg-focus$/],[re,nr,"pointer#Shadow",/^pointer([0-9]*)-shadow$/],[ae,ir,"pointer#ShadowHover",/^pointer([0-9]*)-shadow-hover$/],[U,sr,"pointer#ShadowFocus",/^pointer([0-9]*)-shadow-focus$/],[_,or,"pointer#Border",/^pointer([0-9]*)-border$/],[w,I,"pointer#BorderHover",/^pointer([0-9]*)-border-hover$/],[O,nt,"pointer#BorderFocus",/^pointer([0-9]*)-border-focus$/]],ne=(s,u,m)=>{let f=null,M=[],B=new Map,$=(j,H=u)=>{let N=[...H.classList];for(let ee of N)ee.startsWith(j)&&u.classList.remove(ee)},T=()=>{$("shape");let j=u.querySelectorAll(".pointer");for(let H of j)$("shape",H)},E=j=>{f=j,$("theme-"),typeof j=="string"&&u.classList.add(`theme-${j}`)},W=()=>{if(T(),!(M.length<=0)){u.classList.add("shape",`shape-${M[0]}`);for(let j=1;j<M.length;j++){let H=M[j];if(!H)continue;let N=u.querySelector(`.pointer-${j}`);!N||N.classList.add("shape",`shape-${H}`)}}},q=(j,H)=>{M[j]=H,W()},R=()=>{T();let j=L(s,/^pointer([0-9]*)-shape$/);if(!(j.size<=0)){for(let H of j){let N=H[0];M[N]=H[1]}W()}},K=(j,H)=>`${j}-${H}`,je=(j,H,N)=>{let ee=m[N];if(!ee)return;let ye=N===0?u:ee.$pointer;if(H==null){B.has(K(j,N))&&B.delete(K(j,N)),ye.style.removeProperty(j);return}B.set(K(j,N),H),ye.style.setProperty(j,H)},Me=(j,H)=>B.get(K(j,H));return(()=>{for(let j of Q){let[H,N,ee,ye]=j;if(ye){let ue=L(s,ye);for(let le of ue){let Ce=le[0],De=le[1];je(H,De,Ce)}}else{let ue=s.getAttribute(N);je(H,ue,0)}let ge=[];if(ee.indexOf("#")===-1)ge.push([ee,0]);else{ge.push([ee.replace("#",""),0]),ge.push([ee.replace("#","0"),0]),ge.push([ee.replace("#","1"),0]);for(let ue=1;ue<m.length;ue++)ge.push([ee.replace("#",(ue+1).toString()),ue])}for(let ue of ge)try{let le=ue[0],Ce=ue[1];Object.prototype.hasOwnProperty.call(s,le)||Object.defineProperty(s,le,{get(){return Me(H,Ce)},set:De=>{je(H,De,Ce)}})}catch(le){console.error(le)}}E(s.getAttribute(ze)),R()})(),{setStyle:je,getStyle:Me,get theme(){return f},set theme(j){E(j)},get pointerShapes(){return M},setPointerShape:q}},be="animate-on-click",Ut="range-dragging",Vn=(s,u,m,f)=>{let M=[],B=q=>{for(let R of M)R.update&&typeof R.update=="function"&&R.update(q)},$=()=>{for(let q of M)q.destroy&&typeof q.destroy=="function"&&q.destroy()},T=(q,R)=>{for(let K of M)K.onAttrChange&&typeof K.onAttrChange=="function"&&K.onAttrChange(q,R)},E=q=>{if(q.gettersAndSetters){for(let R of q.gettersAndSetters)if(!(!R.name||!R.attributes))try{Object.prototype.hasOwnProperty.call(s,R.name)||Object.defineProperty(s,R.name,R.attributes)}catch(K){console.error("defineSettersGetters error:",K)}}},W=q=>{var R;if(!q.css)return;let K=(R=s.shadowRoot)==null?void 0:R.querySelector("style");!K||(K.innerHTML+=q.css)};return{init:()=>{if(window.tcRangeSliderPlugins)for(let q of window.tcRangeSliderPlugins){let R=q();M.push(R),R.init&&typeof R.init=="function"&&(R.init(s,u,m,f),E(R),W(R))}},update:B,onAttrChange:T,destroy:$}},Wn=10,Hi=20,jo=(s,u)=>{let m=new Map,f=/^value([0-9]*)$/;for(let T of s.attributes){let E=T.nodeName.trim().toLowerCase();if(!f.test(E))continue;let W=E.replace("value","").trim(),q=W===""||W==="0"||W==="1"?0:z(W,0)-1,R=Ve(T.value)?z(T.value,0):T.value;m.set(q,R)}let M=Math.max(...Array.from(m.keys())),B=[];B.push([Mt(s,u,0),m.get(0)]);let $=u;for(let T=1;T<=M;T++){let E=u.cloneNode(!0);$.after(E),$=E,B.push([Mt(s,E,T),m.get(T)])}return B},qi=(s,u,m,f,M,B,$)=>{try{Object.defineProperty(s,f,{configurable:!0,get(){if(!u)return;let T=u.pointers[m];if(!T)return;let E=u.getTextValue(T.percent);return Ve(E)?z(E,E):E},set:T=>{u.pointers[m]?u?.setValue(T,m):u?.addPointer(T)}}),Object.defineProperty(s,M,{configurable:!0,get(){var T,E;return(E=(T=u?.pointers[m])==null?void 0:T.getAttr("aria-label"))!=null?E:void 0},set:T=>{!u||u.setAriaLabel(m,T)}}),Object.defineProperty(s,B,{configurable:!0,get(){var T,E;return(E=(T=u?.styles)==null?void 0:T.pointerShapes[m])!=null?E:null},set:T=>{!u||!u.styles||u.styles.setPointerShape(m,T)}}),Object.defineProperty(s,$,{configurable:!0,get(){var T;return(T=u?.pointers[m].disabled)!=null?T:!1},set:T=>{if(!u)return;let E=u?.pointers[m];!E||(E.disabled=T)}})}catch(T){console.error(T)}},No=(s,u)=>{let m=[["value","ariaLabel","pointerShape","pointerDisabled",0],["value0","ariaLabel0","pointerShape0","pointer0Disabled",0],["value1","ariaLabel1","pointerShape1","pointer1Disabled",0]];for(let f=2;f<Wn;f++)m.push([`value${f}`,`ariaLabel${f}`,`pointer${f}Shape`,`pointer${f}Disabled`,f-1]);for(let f of m)qi(s,u,f[4],f[0],f[1],f[2],f[3])},Gi=(s,u,m)=>{var f;let M=(f=m.shadowRoot)==null?void 0:f.querySelector(".container");if(M)for(let B of s)u?M.prepend(B.$pointer):M.append(B.$pointer)},ko=(s,u)=>{if(!(!u||s.length<=1)){for(let m of s)m.$pointer.style.zIndex=Hi.toString();u.$pointer.style.zIndex=(Hi*2).toString()}},Hn=0,$t=100,wt=2,zi="0.3s",Uo=(s,u,m)=>{let f=m.map(a=>a[0]),M=null,B=null,$=null,T=null,E=Hn,W=$t,q,R,K=it,je=wt,Me=!1,j=!1,H=!1,N=0,ee=1/0,ye=!1,ge,ue,le=!1,Ce=!1,De=!1,ot=zi,Ji=[],Yi=a=>{le||(a.preventDefault&&a.preventDefault(),vt(a),window.addEventListener("mousemove",vt),window.addEventListener("mouseup",pr),jt(s,a))},pr=a=>{le||(ge=void 0,ue=void 0,window.removeEventListener("mousemove",vt),window.removeEventListener("mouseup",pr),ot&&u.classList.add(be),ur(s,a))},Wo=(a,b)=>{if(f.length<=0)return;if(f.length===1)return f[0].isClicked(a)&&ot&&u.classList.remove(be),f[0];let A=qo(a);if(ye){let J=b,We=gr(J);We!==void 0&&(J=Ft(J,We)),A?(ge=J,ue=0,ot&&u.classList.remove(be)):ge!==void 0&&(ue=J-ge,ge=J)}if(!Ho(a)&&!A){for(let J of f)if(!(!J.isClicked(a)||J.disabled))return ot&&u.classList.remove(be),J;for(let J of f)if(M===J)return J}let Z=1/0,ce=null;for(let J of f){if(J.disabled)continue;let We=Math.abs(b-J.percent);We<Z&&(Z=We,ce=J)}return ce},Ki=()=>f.findIndex(a=>M===a&&!a.disabled),vt=a=>{let b;if(K===Ie){let{height:Z,top:ce}=u.getBoundingClientRect(),J=a.type.indexOf("mouse")!==-1?a.clientY:a.touches[0].clientY;b=Math.min(Math.max(0,J-ce),Z)*100/Z}else{let{width:Z,left:ce}=u.getBoundingClientRect(),J=a.type.indexOf("mouse")!==-1?a.clientX:a.touches[0].clientX;b=Math.min(Math.max(0,J-ce),Z)*100/Z}if((Me||j)&&(b=100-b),M=Wo(a.target,b),M&&ko(f,M),ye&&f.length>1&&ue!==void 0){let Z=f[0],ce=f[f.length-1],J=Z.percent+ue<0,We=ce.percent+ue>100;if(J||We)return;for(let wr=0;wr<f.length;wr++)Ae(wr,f[wr].percent+ue);return}let A=Ki();A!==-1&&(Ae(A,b),M?.$pointer.focus())},hr=a=>{if(le||document.activeElement!==s||M?.disabled)return;a.stopPropagation(),a.preventDefault();let b=a.deltaY<0,A=Me||j,Z=b?!A:A,ce=Ki();ce!==-1&&(Z?Vt(ce,f[ce].percent):Wt(ce,f[ce].percent))},Xi=a=>{le||Ce||(K===Ie?j?Ae(a,100):Ae(a,0):Me?Wt(a,f[a].percent):Vt(a,f[a].percent))},Zi=a=>{le||Ce||(K===Ie?j?Ae(a,0):Ae(a,100):Me?Vt(a,f[a].percent):Wt(a,f[a].percent))},Qi=a=>{le||Ce||(K===Ie?j?Wt(a,f[a].percent):Vt(a,f[a].percent):Me?Ae(a,100):Ae(a,0))},es=a=>{le||Ce||(K===Ie?j?Vt(a,f[a].percent):Wt(a,f[a].percent):Me?Ae(a,0):Ae(a,100))},Ho=a=>a.classList.contains("panel"),qo=a=>a.classList.contains("panel-fill"),Vt=(a,b)=>{if(b===void 0)return;let A=gr(b);A==null&&(A=1),b-=A,b<0&&(b=0),Ae(a,b)},Wt=(a,b)=>{if(b===void 0)return;let A=gr(b);A==null&&(A=1),b+=A,b>100&&(b=100),Ae(a,b)},mt=()=>{!T||T.update({percents:ts(),values:rs(),$pointers:ns(),min:is(),max:ss(),data:zn(),step:Gn(),round:Yn(),type:Jn(),textMin:vr(),textMax:mr(),rightToLeft:Zn(),bottomToTop:Qn(),pointersOverlap:ni(),pointersMinDistance:Kn(),pointersMaxDistance:Xn(),rangeDragging:ii(),disabled:ei(),keyboardDisabled:ti(),mousewheelDisabled:ri()})},Go=()=>{mt()},zo=a=>{if(!(H||f.length<=1||W===E))if(a===0){let b=ee*100/(W-E);return Math.max(0,f[a+1].percent-b)}else{let b=N*100/(W-E);return Math.min(f[a-1].percent+b,100)}},Jo=a=>{if(!(H||f.length<=1||W===E))if(a===f.length-1){let b=ee*100/(W-E);return Math.min(f[a-1].percent+b,100)}else{let b=N*100/(W-E);return Math.max(0,f[a+1].percent-b)}},gr=a=>{let b;if(typeof q=="function"){let A=_t(0,100,E,W,a);b=q(A,a)}else b=q;if(Ve(b)){let A=W-E;return b=A===0?0:b*100/A,b}},Tt=a=>{if(a===void 0)return;let b=_t(0,100,E,W,a);return R!==void 0?R[Math.round(b)]:st(b,je)},vr=()=>R!==void 0?R[E]:E,mr=()=>R!==void 0?R[W]:W,Gn=()=>q,Yo=a=>{var b;return a<=0||H?vr():(b=Tt(f[a-1].percent))!=null?b:""},Ko=a=>{var b;return f.length<=1||a>=f.length-1||H?mr():(b=Tt(f[a+1].percent))!=null?b:""},ts=()=>f.map(a=>a.percent),rs=()=>f.map(a=>Tt(a.percent)),ns=()=>f.map(a=>a.$pointer),is=()=>E,ss=()=>W,zn=()=>R,Jn=()=>K,Yn=()=>je,Kn=()=>N,Xn=()=>ee,Xo=a=>Ji[a],Zn=()=>Me,Qn=()=>j,ei=()=>le,ti=()=>Ce,ri=()=>De,ni=()=>H,ii=()=>ye,Ae=(a,b)=>{if(b===void 0)return;let A=gr(b);A!==void 0&&(b=Ft(b,A));let Z=f[a];if(!Z)return;let ce=Z.updatePosition(b,zo(a),Jo(a),K,Me,j);B?.updatePosition(K,f.map(J=>J.percent),Me,j),mt();for(let J of f){let We=Tt(J.percent);We!==void 0&&(J.setAttr("aria-valuenow",We.toString()),J.setAttr("aria-valuetext",We.toString()))}Qo(),ce&&cr(s,f.map(J=>Tt(J.percent)))},Je=()=>{for(let a=0;a<f.length;a++)Ae(a,f[a].percent)},Zo=(a,b)=>{E=R!==void 0?0:z(a,Hn),W=R!==void 0?R.length-1:z(b,$t),br(E),yr(W)},Qo=()=>{var a,b;for(let A=0;A<f.length;A++){let Z=f[A];Z.setAttr("aria-valuemin",((a=Yo(A))!=null?a:"").toString()),Z.setAttr("aria-valuemax",((b=Ko(A))!=null?b:"").toString())}},br=a=>{E=z(a,Hn),E>W&&(W=E+$t),Je()},yr=a=>{W=z(a,$t),W<E&&(W=E+$t),Je()},os=a=>{H=!0;for(let b=0;b<a.length;b++)Sr(a[b],b);H=!1;for(let b=0;b<a.length;b++)Sr(a[b],b)},Sr=(a,b)=>{let A;R!==void 0?(A=a==null?0:Nt(a,R),A===-1&&(A=0)):(A=z(a,E),A<E&&(A=E),A>W&&(A=W));let Z=_t(E,W,0,100,A);Ae(b,Z)},_r=a=>{if(a==null){q=void 0;return}if(typeof a=="function"){q=a,Je();return}if(Ve(a)){q=z(a,1);let b=Math.abs(W-E);q>b&&(q=void 0),Je();return}q=void 0},si=a=>{H=a,Je()},oi=a=>{(!Ve(a)||a<0)&&(a=0),N=a},ai=a=>{(!Ve(a)||a<0)&&(a=1/0),ee=a},ui=a=>{le=a,u.classList.toggle("disabled",le),le?u.setAttribute("aria-disabled","true"):u.hasAttribute("aria-disabled")&&u.removeAttribute("aria-disabled")},as=a=>{Ce=a},us=a=>{De=a,De?document.removeEventListener("wheel",hr):document.addEventListener("wheel",hr,{passive:!1})},li=a=>{if(a==null){R=void 0;return}if(R=dr(a),R===void 0||R.length<=0){R=void 0;return}br(0),yr(R.length-1),q===void 0&&_r(1)},ci=a=>{var b;typeof a=="string"?K=a.trim().toLowerCase()===Ie?Ie:it:K=it;let A=(b=s.shadowRoot)==null?void 0:b.querySelector(".range-slider-box");if(!A)return;A.className=`range-slider-box type-${K}`,Je();let Z=K===Ie?"vertical":"horizontal";for(let ce of f)ce.setAttr("aria-orientation",Z)},di=a=>{Me=a,f.length>1&&Gi(f,Me,s),Je(),mt()},fi=a=>{j=a,f.length>1&&Gi(f,j,s),Je(),mt()},pi=a=>{je=z(a,wt),je<0&&(je=wt),mt()},ls=a=>{a==null||a.toString().trim().toLowerCase()==="false"?(ot=void 0,u.style.removeProperty(fr),u.classList.remove(be)):(ot=a.toString(),u.style.setProperty(fr,ot),u.classList.add(be))},cs=(a,b)=>{let A=f[a];!A||(A.setAttr("aria-label",b),Ji[a]=b)},Mr=a=>{if(ge=void 0,f.length<=1){ye=!1,u.classList.remove(Ut);return}ye=a,u.classList.toggle(Ut,ye)},ea=()=>{ui(fe(s.getAttribute(Y))),Ce=fe(s.getAttribute(ht)),De=fe(s.getAttribute(rt));let a=L(s,/^pointer([0-9]*)-disabled$/,b=>fe(b));for(let b of a){let A=b[0];!f[A]||(f[A].disabled=b[1])}},ta=()=>{let a=L(s,/^aria-label([0-9]*)$/);for(let b of a){let A=b[0];cs(A,b[1])}},ra=a=>{let b=f.length,A=f[b-1].$pointer,Z=A.cloneNode(!0);A.after(Z);let ce=Mt(s,Z,b);return ce.setCallbacks(Xi,Zi,Qi,es),f.push(ce),Sr(a,b),Je(),mt(),b},na=()=>{let a=f.length,b=f[a-1];return b?(b.destroy(),f.pop(),f.length<=1&&Mr(!1),Je(),mt(),a-1):-1};return(()=>{var a,b;for(let Z of f)Z.setCallbacks(Xi,Zi,Qi,es);let A=(a=s.shadowRoot)==null?void 0:a.querySelector(".panel-fill");A&&(B=Fn(A)),ci(s.getAttribute(_e)),di(fe(s.getAttribute(tt))),fi(fe(s.getAttribute(F))),Zo(s.getAttribute(C),s.getAttribute(oe)),_r(s.getAttribute(k)),li(s.getAttribute(D)),os(m.map(Z=>Z[1])),si(fe(s.getAttribute(c))),oi(z(s.getAttribute(h),0)),ai(z(s.getAttribute(p),1/0)),Mr(fe(s.getAttribute(S))),pi(z(s.getAttribute(se),wt)),ea(),ta(),$=ne(s,u,f),ls((b=s.getAttribute(ar))!=null?b:zi),u.addEventListener("mousedown",Yi),u.addEventListener("mouseup",pr),u.addEventListener("touchmove",vt),u.addEventListener("touchstart",vt),De||document.addEventListener("wheel",hr,{passive:!1}),T=Vn(s,Go,{setValues:os,setMin:br,setMax:yr,setStep:_r,setPointersOverlap:si,setPointersMinDistance:oi,setPointersMaxDistance:ai,setDisabled:ui,setType:ci,setRightToLeft:di,setBottomToTop:fi,setRound:pi,setKeyboardDisabled:as,setMousewheelDisabled:us,setRangeDragging:Mr,setData:li},{getPercents:ts,getValues:rs,getPointerElements:ns,getMin:is,getMax:ss,getStep:Gn,getData:zn,getType:Jn,getRound:Yn,getTextMin:vr,getTextMax:mr,isRightToLeft:Zn,isBottomToTop:Qn,isDisabled:ei,isKeyboardDisabled:ti,isMousewheelDisabled:ri,isPointersOverlap:ni,isRangeDraggingEnabled:ii,getPointersMinDistance:Kn,getPointersMaxDistance:Xn}),T.init()})(),{get pointers(){return f},get styles(){return $},get pluginsManager(){return T},get min(){return vr()},get max(){return mr()},get step(){return Gn()},get pointersOverlap(){return ni()},set pointersOverlap(a){si(a)},get pointersMinDistance(){return Kn()},set pointersMinDistance(a){oi(a)},get pointersMaxDistance(){return Xn()},set pointersMaxDistance(a){ai(a)},get disabled(){return ei()},set disabled(a){ui(a)},get data(){return zn()},get type(){return Jn()},set type(a){ci(a)},get rightToLeft(){return Zn()},set rightToLeft(a){di(a)},get bottomToTop(){return Qn()},set bottomToTop(a){fi(a)},get round(){return Yn()},set round(a){pi(a)},get animateOnClick(){return ot},set animateOnClick(a){ls(a)},get keyboardDisabled(){return ti()},set keyboardDisabled(a){as(a)},get mousewheelDisabled(){return ri()},set mousewheelDisabled(a){us(a)},get rangeDragging(){return ii()},set rangeDragging(a){Mr(a)},setMin:br,setMax:yr,setValue:Sr,setStep:_r,setData:li,getTextValue:Tt,setAriaLabel:cs,getAriaLabel:Xo,addPointer:ra,removePointer:na,destroy:()=>{u.removeEventListener("mousedown",Yi),u.removeEventListener("mouseup",pr),u.removeEventListener("touchmove",vt),u.removeEventListener("touchstart",vt),document.removeEventListener("wheel",hr);for(let a of f)a.destroy();T?.destroy()}}},$o=(s,u,m)=>{let f=Q.find(([T,E,W,q])=>E.replace("#","")===u.replace(/\d+/g,""));if(f&&s.styles){let[T,E,W,q]=f,R=u.replace(/\D/g,"").trim(),K=R===""||R==="0"||R==="1"?0:z(R,0)-1;s.styles.setStyle(T,m,K);return}switch(s&&s.pluginsManager&&s.pluginsManager.onAttrChange(u,m),u){case C:{s.setMin(m);break}case oe:{s.setMax(m);break}case k:{s.setStep(m);break}case c:{s.pointersOverlap=fe(m);break}case h:{s.pointersMinDistance=z(m,0);break}case S:{s.rangeDragging=fe(m);break}case p:{s.pointersMaxDistance=z(m,1/0);break}case Y:{s.disabled=fe(m);break}case ht:{s.keyboardDisabled=fe(m);break}case rt:{s.mousewheelDisabled=fe(m);break}case D:{s.setData(m);break}case _e:{s.type=m;break}case tt:{s.rightToLeft=fe(m);break}case F:{s.bottomToTop=fe(m);break}case se:{s.round=z(m,wt);break}case ze:{s.styles&&(s.styles.theme=m);break}case ar:{s.animateOnClick=m;break}}let M=null;if(/^value([0-9]*)$/.test(u)&&(M="value"),/^pointer([0-9]*)-disabled$/.test(u)&&(M="pointer-disabled"),/^aria-label([0-9]*)$/.test(u)&&(M="aria-label"),/^pointer([0-9]*)-shape$/.test(u)&&(M="pointer-shape"),!M)return;let B=u.replace(/\D/g,"").trim(),$=B===""||B==="0"||B==="1"?0:z(B,0)-1;switch(M){case"value":{s.setValue(m,$);break}case"pointer-disabled":{let T=s?.pointers[$];if(!T)return;T.disabled=fe(m);break}case"aria-label":{s.setAriaLabel($,m);break}case"pointer-shape":{s.styles&&s.styles.setPointerShape($,m);break}}},Vo=class extends HTMLElement{constructor(){super(),r(this,"slider"),r(this,"_externalCSSList",[]),r(this,"_observer",null),this.attachShadow({mode:"open"})}set step(s){this.slider&&this.slider.setStep(s)}get step(){var s;return(s=this.slider)==null?void 0:s.step}set disabled(s){this.slider&&(this.slider.disabled=s)}get disabled(){var s,u;return(u=(s=this.slider)==null?void 0:s.disabled)!=null?u:!1}set data(s){var u;(u=this.slider)==null||u.setData(s)}get data(){var s;return(s=this.slider)==null?void 0:s.data}set min(s){var u;(u=this.slider)==null||u.setMin(s)}get min(){var s;return(s=this.slider)==null?void 0:s.min}set max(s){var u;(u=this.slider)==null||u.setMax(s)}get max(){var s;return(s=this.slider)==null?void 0:s.max}set round(s){!this.slider||(this.slider.round=s)}get round(){var s,u;return(u=(s=this.slider)==null?void 0:s.round)!=null?u:wt}set type(s){!this.slider||(this.slider.type=s??it)}get type(){var s;return((s=this.slider)==null?void 0:s.type)||it}set pointersOverlap(s){!this.slider||(this.slider.pointersOverlap=s)}get pointersOverlap(){var s,u;return(u=(s=this.slider)==null?void 0:s.pointersOverlap)!=null?u:!1}set pointersMinDistance(s){!this.slider||(this.slider.pointersMinDistance=s)}get pointersMinDistance(){var s,u;return(u=(s=this.slider)==null?void 0:s.pointersMinDistance)!=null?u:0}set pointersMaxDistance(s){!this.slider||(this.slider.pointersMaxDistance=s)}get pointersMaxDistance(){var s,u;return(u=(s=this.slider)==null?void 0:s.pointersMaxDistance)!=null?u:1/0}set theme(s){!this.slider||!this.slider.styles||(this.slider.styles.theme=s)}get theme(){var s,u,m;return(m=(u=(s=this.slider)==null?void 0:s.styles)==null?void 0:u.theme)!=null?m:null}set rtl(s){!this.slider||(this.slider.rightToLeft=s)}get rtl(){var s,u;return(u=(s=this.slider)==null?void 0:s.rightToLeft)!=null?u:!1}set btt(s){!this.slider||(this.slider.bottomToTop=s)}get btt(){var s,u;return(u=(s=this.slider)==null?void 0:s.bottomToTop)!=null?u:!1}set keyboardDisabled(s){!this.slider||(this.slider.keyboardDisabled=s)}get keyboardDisabled(){var s,u;return(u=(s=this.slider)==null?void 0:s.keyboardDisabled)!=null?u:!1}set mousewheelDisabled(s){!this.slider||(this.slider.mousewheelDisabled=s)}get mousewheelDisabled(){var s,u;return(u=(s=this.slider)==null?void 0:s.mousewheelDisabled)!=null?u:!1}set animateOnClick(s){!this.slider||(this.slider.animateOnClick=s)}get animateOnClick(){var s;return(s=this.slider)==null?void 0:s.animateOnClick}get rangeDragging(){var s,u;return(u=(s=this.slider)==null?void 0:s.rangeDragging)!=null?u:!1}set rangeDragging(s){this.slider&&(this.slider.rangeDragging=fe(s))}get externalCSSList(){return this._externalCSSList}addPointer(s){var u,m;if(!this.slider)return;let f=(m=(u=this.slider)==null?void 0:u.addPointer(s))!=null?m:0;qi(this,this.slider,f,`value${f+1}`,`ariaLabel${f+1}`,`pointerShape${f+1}`,`pointer${f+1}Disabled`)}removePointer(){var s;!this.slider||(s=this.slider)==null||s.removePointer()}addCSS(s){if(!this.shadowRoot)return;let u=document.createElement("style");u.textContent=s,this.shadowRoot.appendChild(u)}connectedCallback(){var s,u;if(!this.shadowRoot)return;this._externalCSSList=V(this),this.shadowRoot.innerHTML=i(o,this._externalCSSList);let m=(s=this.shadowRoot)==null?void 0:s.querySelector(".pointer");if(!m)return;let f=(u=this.shadowRoot)==null?void 0:u.getElementById("range-slider");if(!f)return;let M=jo(this,m);this.slider=Uo(this,f,M),No(this,this.slider),this._observer=new MutationObserver(B=>{B.forEach($=>{var T;if(!this.slider||$.type!=="attributes")return;let E=$.attributeName;!E||$o(this.slider,E,(T=this.getAttribute(E))!=null?T:"")})}),this._observer.observe(this,{attributes:!0})}disconnectedCallback(){this._observer&&this._observer.disconnect(),this.slider&&this.slider.destroy()}},qn=Vo;window.tcRangeSlider=qn,customElements.get("toolcool-range-slider")||customElements.define("toolcool-range-slider",qn),customElements.get("tc-range-slider")||customElements.define("tc-range-slider",class extends qn{})})();var On=class extends HTMLElement{get range_min(){return Number(this.slider.value1)}set range_min(e){this.slider.value1=e}get range_max(){return Number(this.slider.value2)}set range_max(e){this.slider.value2=e}slider;label_range_min;label_range_max;constructor(){super(),this.attachShadow({mode:"open"});let e=document.createElement("div"),t=document.createElement("span");t.textContent="\u79FB\u52D5\u7BC4\u56F2: ",e.appendChild(t);let r=document.createElement("span");r.textContent="0",e.appendChild(r),this.label_range_min=r;let i=document.createElement("tc-range-slider");i.style.padding="0 1em",i.style.display="inline-block",e.appendChild(i),this.slider=i;let o=document.createElement("span");r.textContent="100",e.appendChild(o),this.label_range_max=o,this.shadowRoot?.append(e),this.slider.addEventListener("change",c=>{this.label_range_min.textContent=String(this.slider.value1),this.label_range_max.textContent=String(this.slider.value2)}),this.slider.addEventListener("mouseup",c=>{console.log(`min: ${this.range_min}, max: ${this.range_max}`)})}InitializeSlider(){this.slider.min=0,this.slider.max=100,this.slider.step=1,this.slider.value1=0,this.slider.value2=100,this.slider.sliderWidth="200px",this.slider.style.padding="0 1em"}};customElements.define("slider-container",On);var Wu;async function Hu(){console.log("main loaded."),Wu=new En}window.onload=Hu;
/*! Bundled license information:

buttplug/dist/main/src/core/Logging.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

buttplug/dist/main/src/core/Messages.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/core/Exceptions.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/core/MessageUtils.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/client/ButtplugClientDevice.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/utils/ButtplugMessageSorter.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/client/ButtplugClientConnectorException.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/client/Client.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/utils/ButtplugBrowserWebsocketConnector.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/client/ButtplugBrowserWebsocketClientConnector.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/client/ButtplugNodeWebsocketClientConnector.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/client/IButtplugClientConnector.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)

buttplug/dist/main/src/index.js:
  (*!
   * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
   * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
   * project root for full license information.
   *
   * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
   *)
*/
